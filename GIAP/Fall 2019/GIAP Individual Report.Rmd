---
title: ""
output:
  html_document:
    theme: cosmo
always_allow_html: yes
bibliography: bibliography.bib
nocite: | 
  @author1, @author2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, comment=NA, fig.width = 6, fig.asp = 0.618,
out.width = "60%", fig.align = "center", fig.show='hold')
```

```{css, echo=FALSE}
    body .main-container {
      width: 80% !important;  
      margin-left: 10% !important;
      margin-right: 10% !important;
    }
    body {
      width: 80% !important;
      margin-left: 10% !important;
      margin-right: 10% !important;
    }
```

```{r initialize}
hospital_names <- unique(giap$`Hospital.Name`)[!is.na(unique(giap$`Hospital.Name`))]
cohort_n <- nrow(giap)
hospital_n <- nrow(giap %>% filter(Hospital.Name==name))
id <- unique(giap$Hospital.ID[giap$Hospital.Name==name] %>% na.omit())
wrap_15 <- wrap_format(15)
wrap_20 <- wrap_format(20)
```

```{r, fig.align = "left", out.width='15%'}
knitr::include_graphics("NICHE_logo.jpg")
```

<center>
# **Nurses Improving Care for Healthsystem Elders**
## **Geriatric Institutional Assessment Profile Report**
### **`r cohort` Cohort**
#### **`r name`**
</center>

### **How to use the GIAP Results to Establish a Robust NICHE Program**

The information generated from the GIAP is used to identify strengths and prioritize opportunities to improve nursing practice to develop age-friendly care for older adults receiving care at your hospital. Nursing staff on the designated NICHE units were randomly selected to complete the GIAP. Please refer to the GIAP Toolkit available in the *NICHE Knowledge Center* for additional information about the method used to create this report.   

### **Step 1:  NICHE Practice Model**

NICHE is an evidence-based geriatric care model that focuses on developing nurse workforce expertise in the care of older adults. The NICHE model supports professional nursing practice by positioning nurses as leaders on their units to use evidence-based practices that address common health problems experienced by older adults.

**NICHE Program Values**

* Patient-centered care 
* Evidence-based care at the bedside
* Healthy work environments 
* Etc…

**NICHE Practice Model**

<add image>

The NICHE Practice Model and the GIAP data

The GIAP data offers insights into nurses' knowledge and attitudes about older adults and their perceptions of the practice environment to provide quality care that meets the unique needs of older adults. This diagram illustrates how to use the GIAP results to support the development of the NICHE program on the participating nursing units.

**NICHE Practice Model**

<add image>

### **Step 2:  Action Plan Model**

We outline some general practices for how to use the GIAP survey results to enhance how your organization best communicates, makes decisions and takes action to develop workforce competencies to consistently use evidence-based practices to care for the population of older adults for whom you provide care. While each hospital may go about implementing the NICHE practice model to meet their specific goals, these general guidelines provide a starting point to guide your work.

**Action Plan Steps**

<add image>

**Recommended Action Plan Timeline to Integrate GIAP Results into NICHE Program Implementation Efforts**

We recommend the following action plan to establish NICHE at your hospital

```{r action_plan_table}
htmltools::includeHTML("action_plan_table_code.txt")
```


### **Step 3: General Recommendations for Implementing NICHE**

1.	Communicate the benefits of nurse-led services to address older adults’ health and wellness needs to patients, families, nursing staff and other professional colleagues. 

2.	Work with your hospital’s QI Department to segment clinical outcome data into the age groups of 65-74 years, 75-85 years, 85+ years to understand differences in care for each group.

3.	Align the improvement priorities for older adults with the hospitals’ broader nursing quality improvement goals. Document changes in nurse-sensitive outcomes attributed to NICHE initiatives. 

4.	Work closely with your hospitals’ nurse managers, shared governance councils, human resources department, and union representatives to set practice standards and support full scope of practice to establish nurse-led services for older adults.   

5.	Use the SPICES tool to guide nursing care plans and daily huddles to identify at risk older adults.  Supplement nursing care plans with the Institute for Health Improvement’s (IHI) 4M model-mobility, mentation, medications, and what matters-to ensure holistic and patient-centered care tailored to the needs of older adults.  Work towards having all nursing staff integrate the SPICES and 4M model to plan and provide care. 

**Specific Recommendations to Develop Geriatric Nursing Excellence**

```{r recommendations_table}
htmltools::includeHTML("recommendations_table_code.txt")
```


### **Step 4: Review GIAP Results**

A total of `r nrow(giap %>% filter(Hospital.Name==name))` nurses at `r name` provided compete data for the questions included in this report. Of the eligible staff invited to participate in the GIAP, `r round(nrow(giap)/eligible_nurses*100,2)`% completed the survey.  As you review the your hospitals’ results, keep in mind that a mean score of 80% on each of the GIAP sections demonstrates nurses’ mastery of geriatric nursing concepts and reflects a unit environment that supports age-friendly care.

**Participating Staff**

```{r}
giap %>%
  filter(!is.na(Q21))%>%
  rename(Gender = Q21) %>%
  count(Gender) %>%
  mutate(n = round(n / sum(n) * 100, 1),
         Gender = case_when(Gender == 1 ~ "Male",
                            Gender == 2 ~ "Female",
                            Gender == 3 ~ "Prefer not to Report",
                            Gender == 9 ~ "Prefer not to Report"),
         Gender = factor(Gender, levels = c("Prefer not to Report", "Male", "Female"))) %>%
  arrange(desc(n)) %>% 
  full_join(giap %>%
              filter(Hospital.Name ==name, !is.na(Q21)) %>%
              rename(Gender = Q21) %>%
              count(Gender) %>%
              mutate(n = round(n / sum(n) * 100, 1),
                     Gender = case_when(Gender == 1 ~ "Male",
                                        Gender == 2 ~ "Female",
                                        Gender == 3 ~ "Prefer not to Report",
                                        Gender == 9 ~ "Prefer not to Report"),
                     Gender = factor(Gender, levels = c("Prefer not to Report", "Male", "Female"))),
            by = "Gender") %>%
  setNames(c("Gender", "Cohort (%)", "Hospital (%)")) %>%     
  mutate_if(is.numeric, na_to_zero) %>% 
  kable(format = "html", table.attr = "style='width:90%;'") %>% 
  kable_styling() %>% 
  column_spec(1, width = "30em") %>%
  column_spec(2, width = "10em") %>% 
  column_spec(3, width = "10em")
```


```{r}
giap %>%
  filter(!is.na(Q22), Q22 ==1) %>%
  mutate(Q22 = case_when(Q22 == 1 ~ "Hispanic or Latino/Latina")) %>% 
  rename(Ethnicity = Q22) %>% 
  count(Ethnicity)%>% 
  rbind({giap %>%
      filter(!is.na(Q23_1), Q23_1 ==1) %>%
      mutate(Q23_1 = case_when(Q23_1 == 1 ~ "American Indian or Alaskan Native")) %>% 
      rename(`Ethnicity` = Q23_1) %>% 
      count(Ethnicity)}) %>% 
  rbind({giap %>%
      filter(!is.na(Q23_2), Q23_2 ==1) %>%
      mutate(Q23_2 = case_when(Q23_2 == 1 ~ "Asian")) %>% 
      rename(`Ethnicity` = Q23_2) %>%
      count(`Ethnicity`)}) %>% 
  rbind({giap %>%
      filter(!is.na(Q23_3), Q23_3 ==1) %>%
      mutate(Q23_3 = case_when(Q23_3 == 1 ~ "Black or African American")) %>% 
      rename(`Ethnicity` = Q23_3) %>%
      count(`Ethnicity`)}) %>% 
  rbind({giap %>%
      filter(!is.na(Q23_4), Q23_4==1) %>%
      mutate(Q23_4 = case_when(Q23_4 == 1 ~ "Native Hawaiian or Pacific Islander")) %>% 
      rename(`Ethnicity` = Q23_4) %>%
      count(`Ethnicity`)}) %>% 
  rbind({giap %>%
      filter(!is.na(Q23_5), Q23_5==1) %>%
      mutate(Q23_5 = case_when(Q23_5 == 1 ~ "White")) %>% 
      rename(`Ethnicity` = Q23_5) %>%
      count(`Ethnicity`)}) %>% 
  rbind({giap %>%
      filter(!is.na(Q23_6), Q23_6==1) %>%
      mutate(Q23_6 = case_when(Q23_6 == 1 ~ "Other")) %>% 
      rename(`Ethnicity` = Q23_6) %>%
      count(`Ethnicity`)}) %>% 
  {.[order(.$n, decreasing = T),]} %>% 
  rbind(c("Ethnicity" = "Prefer Not to Report", 
          "n" = nrow(giap %>% 
                       filter((Q23_1==9&Q23_2==9&Q23_3==9&Q23_4==9&Q23_5==9&Q23_6==9) |
                                (Q23_1==0&Q23_2==0&Q23_3==0&Q23_4==0&Q23_5==0&Q23_6==0))))) %>% 
  mutate(n = as.numeric(n),
         n = round(n / sum(n) * 100, 1)) %>% 
  rename(Count = n) %>% 
  full_join(giap %>%
  filter(Hospital.Name ==name,!is.na(Q22), Q22 ==1) %>%
  mutate(Q22 = case_when(Q22 == 1 ~ "Hispanic or Latino/Latina")) %>% 
  rename(Ethnicity = Q22) %>% 
  count(Ethnicity)%>% 
  rbind({giap %>%
      filter(Hospital.Name ==name,!is.na(Q23_1), Q23_1 ==1) %>%
      mutate(Q23_1 = case_when(Q23_1 == 1 ~ "American Indian or Alaskan Native")) %>% 
      rename(`Ethnicity` = Q23_1) %>% 
      count(Ethnicity)}) %>% 
  rbind({giap %>%
      filter(Hospital.Name ==name,!is.na(Q23_2), Q23_2 ==1) %>%
      mutate(Q23_2 = case_when(Q23_2 == 1 ~ "Asian")) %>% 
      rename(`Ethnicity` = Q23_2) %>%
      count(`Ethnicity`)}) %>% 
  rbind({giap %>%
      filter(Hospital.Name ==name,!is.na(Q23_3), Q23_3 ==1) %>%
      mutate(Q23_3 = case_when(Q23_3 == 1 ~ "Black or African American")) %>% 
      rename(`Ethnicity` = Q23_3) %>%
      count(`Ethnicity`)}) %>% 
  rbind({giap %>%
      filter(Hospital.Name ==name,!is.na(Q23_4), Q23_4==1) %>%
      mutate(Q23_4 = case_when(Q23_4 == 1 ~ "Native Hawaiian or Pacific Islander")) %>% 
      rename(`Ethnicity` = Q23_4) %>%
      count(`Ethnicity`)}) %>% 
  rbind({giap %>%
      filter(Hospital.Name ==name,!is.na(Q23_5), Q23_5==1) %>%
      mutate(Q23_5 = case_when(Q23_5 == 1 ~ "White")) %>% 
      rename(`Ethnicity` = Q23_5) %>%
      count(`Ethnicity`)}) %>% 
  rbind({giap %>%
      filter(Hospital.Name ==name,!is.na(Q23_6), Q23_6==1) %>%
      mutate(Q23_6 = case_when(Q23_6 == 1 ~ "Other")) %>% 
      rename(`Ethnicity` = Q23_6) %>%
      count(`Ethnicity`)}) %>% 
  {.[order(.$n, decreasing = T),]} %>% 
  rbind(c("Ethnicity" = "Prefer Not to Report", 
          "n" = nrow(giap %>% filter(Hospital.Name==name & 
                   ((Q23_1==9 & Q23_2==9& Q23_3==9& Q23_4==9& Q23_5==9 & Q23_6==9) | 
                      (Q23_1==0 & Q23_2==0& Q23_3==0& Q23_4==0& Q23_5==0 & Q23_6==0)))))) %>% 
  mutate(n = as.numeric(n),
         n = round(n / sum(n) * 100, 1)) %>% 
  rename(Count = n), by = "Ethnicity") %>% 
  mutate_if(is.numeric, na_to_zero) %>% 
  setNames(c("Ethnicity", "Cohort (%)", "Hospital (%)")) %>% 
  kable(format = "html", table.attr = "style='width:90%;'") %>% 
  kable_styling() %>% 
  column_spec(1, width = "30em") %>%
  column_spec(2, width = "10em") %>% 
  column_spec(3, width = "10em")
```

```{r}
giap %>% 
  select(Q2) %>% 
  mutate(Cat = case_when(Q2 <= 1 ~ 1,
                         Q2 > 1 & Q2 <= 5 ~ 2,
                         Q2 > 5 & Q2 <= 10 ~ 3,
                         Q2 > 10 & Q2 <= 15 ~ 4,
                         Q2 > 15 & Q2 <= 20 ~ 5,
                         Q2 > 20 & Q2 < 40 ~ 6,
                         Q2 >= 40 & Q2 < 80 ~ 7,
                         is.na(Q2) ~ 8,
                         Q2 == 99 ~ 8),
         Term = case_when(Cat == 1 ~ "Less than 1 year",
                          Cat == 2 ~ "Between 1 and 5 years",
                          Cat == 3 ~ "Between 5 and 10 years",
                          Cat == 4 ~ "Between 10 and 15 years",
                          Cat == 5 ~ "Between 15 and 20 years",
                          Cat == 6 ~ "Between 20 and 40 years",
                          Cat == 7 ~ "40 and above",
                          Cat == 8 ~ "Prefer Not to Report")) %>% 
  group_by(Term, Cat) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  arrange(Cat) %>% 
  rename(Experience = Term) %>% 
  select(-Cat) %>%
  full_join(giap %>% 
  filter(Hospital.Name == name) %>% 
  select(Q2) %>% 
  mutate(Cat = case_when(Q2 <= 1 ~ 1,
                         Q2 > 1 & Q2 <= 5 ~ 2,
                         Q2 > 5 & Q2 <= 10 ~ 3,
                         Q2 > 10 & Q2 <= 15 ~ 4,
                         Q2 > 15 & Q2 <= 20 ~ 5,
                         Q2 > 20 & Q2 < 40 ~ 6,
                         Q2 >= 40 & Q2 < 80 ~ 7,
                         is.na(Q2) ~ 8,
                         Q2 == 99 ~ 8),
         Term = case_when(Cat == 1 ~ "Less than 1 year",
                          Cat == 2 ~ "Between 1 and 5 years",
                          Cat == 3 ~ "Between 5 and 10 years",
                          Cat == 4 ~ "Between 10 and 15 years",
                          Cat == 5 ~ "Between 15 and 20 years",
                          Cat == 6 ~ "Between 20 and 40 years",
                          Cat == 7 ~ "40 and above",
                          Cat == 8 ~ "Prefer Not to Report")) %>% 
  group_by(Term, Cat) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  arrange(Cat) %>% 
  rename(Experience = Term) %>% 
  select(-Cat), by = "Experience") %>%
  mutate_if(is.numeric, na_to_zero) %>%
  setNames(c("Years of Practice Experience", "Cohort (%)", "Hospital (%)")) %>%    
  as.data.frame() %>% 
  kable(format = "html", table.attr = "style='width:90%;'") %>% 
  kable_styling() %>% 
  column_spec(1, width = "30em") %>%
  column_spec(2, width = "10em") %>% 
  column_spec(3, width = "10em")
```


```{r}
giap %>% 
  select(Q30) %>% 
  mutate(Q30 = ifelse(is.na(Q30), 9, Q30),
         Degree = case_when(Q30 == 1 ~ "Diploma",
                            Q30 == 2 ~ "Associate Degree",
                            Q30 == 3 ~ "Baccalaureate Degree",
                            Q30 == 4 ~ "Master Degree",
                            Q30 == 5 ~ "Doctorate",
                            Q30 == 6 ~ "I am not a registered nurse",
                            Q30 == 9 ~ "Prefer not to Report")) %>% 
  group_by(Q30, Degree) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  select(-Q30) %>% 
  full_join(giap %>% 
  filter(Hospital.Name == name) %>% 
  select(Q30) %>% 
  mutate(Q30 = ifelse(is.na(Q30), 9, Q30),
         Degree = case_when(Q30 == 1 ~ "Diploma",
                            Q30 == 2 ~ "Associate Degree",
                            Q30 == 3 ~ "Baccalaureate Degree",
                            Q30 == 4 ~ "Master Degree",
                            Q30 == 5 ~ "Doctorate",
                            Q30 == 6 ~ "I am not a registered nurse",
                            Q30 == 9 ~ "Prefer not to Report")) %>% 
  group_by(Q30, Degree) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  select(-Q30), by = "Degree") %>% 
  mutate_if(is.numeric, na_to_zero) %>%
  setNames(c("Education", "Cohort (%)", "Hospital (%)")) %>%    
  as.data.frame() %>% 
  kable(format = "html", table.attr = "style='width:90%;'") %>% 
  kable_styling() %>% 
  column_spec(1, width = "30em") %>%
  column_spec(2, width = "10em") %>% 
  column_spec(3, width = "10em")
```


```{r}
giap %>% 
  select(Q35) %>% 
  mutate(Q35 = ifelse(is.na(Q35), 9, Q35),
         Shift = case_when(Q35 == 1 ~ "8-hour shifts",
                            Q35 == 2 ~ "10-hour shifts",
                            Q35 == 3 ~ "12-hour shifts",
                            Q35 == 4 ~ "Flexible Schedule",
                            Q35 == 5 ~ "Other",
                            Q35 == 9 ~ "Did not Answer")) %>% 
  group_by(Shift, Q35) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  arrange(Q35) %>%
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  select(-Q35) %>% 
  full_join(giap %>% 
  filter(Hospital.Name == name) %>% 
  select(Q35) %>% 
  mutate(Q35 = ifelse(is.na(Q35), 9, Q35),
         Shift = case_when(Q35 == 1 ~ "8-hour shifts",
                            Q35 == 2 ~ "10-hour shifts",
                            Q35 == 3 ~ "12-hour shifts",
                            Q35 == 4 ~ "Flexible Schedule",
                            Q35 == 5 ~ "Other",
                            Q35 == 9 ~ "Did not Answer")) %>% 
  group_by(Shift, Q35) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  arrange(Q35) %>%
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  select(-Q35), by = "Shift") %>% 
  mutate_if(is.numeric, na_to_zero) %>%
  setNames(c("Shift Length", "Cohort (%)", "Hospital (%)")) %>%    
  as.data.frame() %>% 
  kable(format = "html", table.attr = "style='width:90%;'") %>% 
  kable_styling() %>% 
  column_spec(1, width = "30em") %>%
  column_spec(2, width = "10em") %>% 
  column_spec(3, width = "10em")
```


```{r}
giap %>% 
  select(Q36) %>% 
  mutate(Q36 = ifelse(is.na(Q36), 9, Q36),
         Work = case_when(Q36 == 1 ~ "Day",
                            Q36 == 2 ~ "Evening",
                            Q36 == 3 ~ "Night",
                            Q36 == 4 ~ "Rotating Schedule",
                            Q36 == 9 ~ "Did not Answer")) %>% 
  group_by(Work, Q36) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  arrange(Q36) %>% 
  select(-Q36) %>% 
  full_join(giap %>% 
  filter(Hospital.Name == name) %>% 
  select(Q36) %>% 
  mutate(Q36 = ifelse(is.na(Q36), 9, Q36),
         Work = case_when(Q36 == 1 ~ "Day",
                            Q36 == 2 ~ "Evening",
                            Q36 == 3 ~ "Night",
                            Q36 == 4 ~ "Rotating Schedule",
                            Q36 == 9 ~ "Did not Answer")) %>% 
  group_by(Work, Q36) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  arrange(Q36) %>% 
  select(-Q36), by = "Work") %>% 
  mutate_if(is.numeric, na_to_zero) %>%
  setNames(c("Work Schedule", "Cohort (%)", "Hospital (%)")) %>%    
  as.data.frame() %>% 
  kable(format = "html", table.attr = "style='width:90%;'") %>% 
  kable_styling() %>% 
  column_spec(1, width = "30em") %>%
  column_spec(2, width = "10em") %>% 
  column_spec(3, width = "10em") 
```

**Nurses' Job Satisfaction**

This diagram illustrates nurses' job satisfaction.

```{r, fig.width=7, fig.height= 5 , out.width = "75%"}
question <- "I am satisfied with my current job"
# Cohort
cohort_data <- giap %>%
  filter(!is.na(Q32), Q32 != 9) %>%
  rename(`Response` = Q32) %>%
  {sum(.$Response==1 | .$Response == 2)/cohort_n}
# Hospital
hospital_data <- giap %>%
  filter(!is.na(Q32), Q32 != 9, Hospital.Name==name) %>%
  rename(`Response` = Q32) %>%
  {sum(.$Response==1 | .$Response == 2)/hospital_n}
df <- data.frame(matrix(nrow=2, ncol = 2))
names(df) <- c("variable", "percentage")
df$variable <- c("Cohort", name)
df$percentage <- round(c(cohort_data, hospital_data),2)
df <- df %>% mutate(group = ifelse(percentage <0.5, "red",
                                 ifelse(percentage>=0.5 & percentage<0.75, "yellow","green")),
                    label = paste0(percentage*100, "%"),
                    title = wrap_35(variable))
ggplot(df, aes(fill = group, ymax = percentage, ymin = 0, xmax = 2, xmin = 1)) +
  geom_rect(aes(ymax=1, ymin=0, xmax=2, xmin=1), fill ="#faf9eb", color = 'black') +
  geom_rect() + 
  coord_polar(theta = "y",start=-pi/2) + xlim(c(0, 2)) + ylim(c(0,2)) +
  geom_text(aes(x = 0, y = 0, label = label, colour=group), size=6.5) +
  geom_text(aes(x=1.5, y=1.5, label=title), size=4.2) + 
  facet_wrap(~title, ncol = 2) +
  theme_void() +
  scale_fill_manual(values = c("red"="#AE6180", "yellow"="#FFC842", "green"="#6BAB8A")) +
  scale_colour_manual(values = c("red"="#AE6180", "yellow"="#FFC842", "green"="#6BAB8A")) +
  theme(strip.background = element_blank(),
        strip.text.x = element_blank()) +
  guides(fill=FALSE) +
  guides(colour=FALSE)
```

**Nurses’ Views on Working with Older Adults **

This diagram depicts the extent to which staff nurses find working with older adults to be rewarding

```{r, fig.width=7, fig.height= 5 , out.width = "75%"}
question <- "How rewarding is your work with older adults"

# Cohort
cohort_data <- giap %>%
  filter(!is.na(Q12), Q12 != 9) %>%
  rename(`Response` = Q12) %>%
  {sum(.$Response==1 | .$Response == 2)/cohort_n}

# Hospital
hospital_data <- giap %>%
  filter(!is.na(Q12), Q12 != 9, Hospital.Name==name) %>%
  rename(`Response` = Q12) %>%
  {sum(.$Response==1 | .$Response == 2)/hospital_n}

data <- data.frame(
  variable=c("Cohort", name),
  percentage=round(c(cohort_data, hospital_data),2)
)


data <- data %>% mutate(group = ifelse(percentage <0.5, "red",
                                 ifelse(percentage>=0.5 & percentage<0.75, "yellow","green")),
                    label = paste0(percentage*100, "%"),
                    title = wrap_35(variable))

ggplot(data, aes(fill = group, ymax = percentage, ymin = 0, xmax = 2, xmin = 1)) +
  geom_rect(aes(ymax=1, ymin=0, xmax=2, xmin=1), fill ="#faf9eb", color = 'black') +
  geom_rect() + 
  coord_polar(theta = "y",start=-pi/2) + 
  xlim(c(0, 2)) + 
  ylim(c(0,2)) +
  geom_text(aes(x = 0, y = 0, label = label, colour=group), size=6.5) +
  geom_text(aes(x=1.5, y=1.5, label=title), size=4.2) + 
  facet_wrap(~title, ncol = 2) +
  theme_void() +
  scale_fill_manual(values = c("red"="#AE6180", "yellow"="#FFC842", "green"="#6BAB8A")) +
  scale_colour_manual(values = c("red"="#AE6180", "yellow"="#FFC842", "green"="#6BAB8A")) +
  theme(strip.background = element_blank(),
        strip.text.x = element_blank()) +
  guides(fill=FALSE) +
  guides(colour=FALSE)
```

### **Nurses’ Attitudes Toward Aging and Knowledge of the Geriatric Syndromes**

The following GIAP questions focus on nurses’ attitudes about aging and their knowledge to identify and manage the constellation of symptoms, known as the geriatric syndromes, experienced by older adults. 

**Attitudes About Aging**

This figure illustrates staffs’ beliefs about aging and older adults. These question are drawn from  Passmore’s Facts on Aging Quiz. Below is a graph of the mean scores with 1 standard deviation on those 10 questions.

```{r attitudes_about_aging, fig.width = 8, fig.asp = 0.4, out.width='80%'}

aging_attitudes_questions <- c("Q41_1", "Q41_2", "Q41_3", "Q41_4", "Q41_5", "Q41_6", "Q41_7", "Q41_8", 
                               "Q41_9", "Q41_10")

aging_attitudes_question_correct <- function(row){
  row[is.na(row)]<-2
  answers <- c(0, 0, 1, 0, 1, 1, 0, 0, 0, 1)
  responses <- as.numeric(tail(row, -2))
  score <- sum(answers == responses)/10
  return(score)
}

cohort_results <- giap %>%
  select(Hospital.Name, CASEID, aging_attitudes_questions) %>%
  as.matrix(.) %>% 
  apply(1, aging_attitudes_question_correct)

hospital_results <- giap %>%
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, aging_attitudes_questions) %>%
  as.matrix(.) %>% 
  apply(1, aging_attitudes_question_correct)

name_vec <- c("Cohort", name)

data <- data.frame(
  name= name_vec,
  value=c(mean(cohort_results), mean(hospital_results)),
  sd=c(sd(cohort_results), sd(hospital_results))
)

data <- data %>% 
  mutate(name = ordered(name, levels = rev(name_vec)))

ggplot(data) +
    geom_bar(aes(x=name, y=value), stat="identity", fill="skyblue", alpha=0.75, width=.4) +
    geom_errorbar(aes(x=name, ymin=value-sd, ymax=value+sd), colour="orange", width = 0.2, alpha=0.9, size=.5) +
  labs(x="", y="") +
  scale_y_continuous(labels = percent_format()) +
  coord_flip()+
  theme_minimal() +
  theme(legend.position = "right", 
        text = element_text(size = 14, color = "black"), 
        panel.border = element_blank())

```

**Clinical Knowledge**

This figure illustrates nurses’ knowledge of care of older adults. Participating registered nurses were asked to select the most appropriate nursing action for twenty clinical scenarios. The number of questions for each clinical topic ranged between one and three questions. The answers for each question on the same clinical topic (eg: medication safety) were averaged to create a mean score.  


```{r}
knowledge <- giap %>%
  select(Hospital.Name, CASEID, Q42b, Q43c, Q44c, Q45b, Q46b, Q51b, Q47a, Q48d, Q49c, 
         Q50b, Q58c, Q59b, Q52a, Q56b, Q53b, Q55c, Q54c, Q57b, Q60c, Q61b) %>% 
  mutate_at(vars("Q42b", "Q43c", "Q44c", "Q45b", "Q46b", "Q51b", "Q47a", "Q48d", "Q49c",
                 "Q50b", "Q58c", "Q59b", "Q52a", "Q56b", "Q53b", "Q55c", "Q54c", "Q57b", 
                 "Q60c", "Q61b"), na_to_zero) %>%
  mutate(Falls = 0,
         Falls = ifelse(as.numeric(Q42b) == 1, Falls + 1, Falls + 0),
         Falls = ifelse(as.numeric(Q43c) == 1, Falls + 1, Falls + 0),
         Skin = 0,
         Skin = ifelse(as.numeric(Q44c) == 1, Skin + 1, Skin + 0),
         Skin = ifelse(as.numeric(Q45b) == 1, Skin + 1, Skin + 0),
         Assess = 0,
         Assess = ifelse(as.numeric(Q46b) == 1, Assess + 1, Assess + 0),
         Assess = ifelse(as.numeric(Q51b) == 1, Assess + 1, Assess + 0),
         Delirium = 0,
         Delirium = ifelse(as.numeric(Q47a) == 1, Delirium + 1, Delirium + 0),
         Urinary = 0,
         Urinary = ifelse(as.numeric(Q48d) == 1, Urinary + 1, Urinary + 0),
         Urinary = ifelse(as.numeric(Q49c) == 1, Urinary + 1, Urinary + 0),
         Nutrition = 0,
         Nutrition = ifelse(as.numeric(Q59b) == 1, Nutrition + 1, Nutrition + 0),
         Nutrition = ifelse(as.numeric(Q50b) == 1, Nutrition + 1, Nutrition + 0),
         Nutrition = ifelse(as.numeric(Q58c) == 1, Nutrition + 1, Nutrition + 0),
         Sleep = 0,
         Sleep = ifelse(as.numeric(Q52a) == 1, Sleep + 1, Sleep + 0),
         Sleep = ifelse(as.numeric(Q56b) == 1, Sleep + 1, Sleep + 0),
         Dementia = 0,
         Dementia = ifelse(as.numeric(Q53b) == 1, Dementia + 1, Dementia + 0),
         Dementia = ifelse(as.numeric(Q55c) == 1, Dementia + 1, Dementia + 0),
         Medication = 0,
         Medication = ifelse(as.numeric(Q54c) == 1, Medication + 1, Medication + 0),
         Medication = ifelse(as.numeric(Q57b) == 1, Medication + 1, Medication + 0),
         Depression = 0,
         Depression = ifelse(as.numeric(Q60c) == 1, Depression + 1, Depression + 0),
         Depression = ifelse(as.numeric(Q61b) == 1, Depression + 1, Depression + 0),
         Total = Falls + Skin + Assess + Delirium + Urinary + Nutrition + Sleep + 
           Dementia + Medication + Depression)
NICHE_colors <- c("#57068C","#6199AE","#FFC842","#314383","#6BAB8A","#F09C5D")
```

```{r knowledge}
#######################
# Falls
#######################

falls_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Falls) %>% 
  mutate(Score = Falls/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Falls")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Falls") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question"))

Falls <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Falls_H = mean(Score))

falls_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Falls) %>% 
  mutate(Score = Falls/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Falls")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Falls") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question"))

#######################
# Skin
#######################

skin_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Skin) %>% 
  mutate(Score = Skin/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Skin")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Skin") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Skin <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Skin_H = mean(Score))

skin_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Skin) %>% 
  mutate(Score = Skin/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Skin")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Skin") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)

#######################
# Assess
#######################

assess_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Assess) %>% 
  mutate(Score = Assess/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Assess")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Assess") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Assess <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Assess_H = mean(Score))

assess_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Assess) %>% 
  mutate(Score = Assess/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Assess")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Assess") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)

#######################
# Delirium
#######################

delirium_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Delirium) %>% 
  mutate(Score = Delirium,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Delirium")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Delirium") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Delirium <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Delirium_H = mean(Score))

delirium_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Delirium) %>% 
  mutate(Score = Delirium,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Delirium")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Delirium") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)

#######################
# Urinary
#######################

urinary_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Urinary) %>% 
  mutate(Score = Urinary/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Urinary")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Urinary") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Urinary <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Urinary_H = mean(Score))

urinary_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Urinary) %>% 
  mutate(Score = Urinary/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Urinary")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Urinary") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)

#######################
# Nutrition
#######################

nutrition_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Nutrition) %>% 
  mutate(Score = Nutrition/3,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Nutrition")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Nutrition") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Nutrition <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Nutrition_H = mean(Score))

nutrition_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Nutrition) %>% 
  mutate(Score = Nutrition/3,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Nutrition")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Nutrition") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)

#######################
# Sleep
#######################

sleep_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Sleep) %>% 
  mutate(Score = Sleep/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Sleep")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Sleep") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Sleep <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Sleep_H = mean(Score))

sleep_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Sleep) %>% 
  mutate(Score = Sleep/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Sleep")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Sleep") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)

#######################
# Dementia
#######################

dementia_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Dementia) %>% 
  mutate(Score = Dementia/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Dementia")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Dementia") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Dementia <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Dementia_H = mean(Score))

dementia_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Dementia) %>% 
  mutate(Score = Dementia/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Dementia")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Dementia") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)

#######################
# Medication
#######################

medication_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Medication) %>% 
  mutate(Score = Medication/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Medication")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Medication") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Medication <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Medication_H = mean(Score))

medication_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Medication) %>% 
  mutate(Score = Medication/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Medication")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Medication") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)

#######################
# Depression
#######################

depression_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Depression) %>% 
  mutate(Score = Depression/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Depression")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Depression") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Depression <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Depression_H = mean(Score))

depression_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Depression) %>% 
  mutate(Score = Depression/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Depression")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Depression") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)

mean_list_h <- mean_list_h %>% 
  mutate(Mean = as.numeric(as.character(Mean)))

mean_list_all <- mean_list_all %>% 
  mutate(Mean = as.numeric(as.character(Mean)))
```

```{r}
all <- mean_list_all

all <- cbind(all, h) %>% 
  setNames(c("Mean_C", "Question", "Mean_H", "Question_2")) %>% 
  select(Question, Mean_C, Mean_H)
```

<center>
**Cohort Knowledge**
</center>

```{r, fig.width = 8, fig.asp = 0.4, out.width='80%'}
all %>% 
  ggplot() +
  geom_segment(aes(x=Question ,xend=Question, y=0, yend = Mean_H), color="grey") +
  geom_point(aes(x=Question, y=Mean_C,color="#69b3a2"), size=5) +
  geom_point(aes(x=Question, y=Mean_H,color="#add8e6"), size=5) +
  scale_y_continuous(labels = percent_format()) +
  scale_color_manual(values = c("#69b3a2", "#add8e6"),
                       labels = c("Cohort", wrap_20(name))) +
  theme(
    panel.grid.minor.y = element_blank(),
    panel.grid.major.y = element_blank(),
    axis.text = element_text( size=12 )
  ) +
  theme_minimal() +
  ylim(0,1) +
  labs(x = "", y = "", colour = "Legend")+
  coord_flip()
```


```{r}
mean_list_all %>% 
  ggplot( aes(x=Question, y=Mean)) +
  geom_segment( aes(x=Question ,xend=Question, y=0, yend=Mean), color="grey") +
  geom_point(size=5, color="#69b3a2") +
  coord_flip() +
  theme(
    panel.grid.minor.y = element_blank(),
    panel.grid.major.y = element_blank(),
    axis.text = element_text( size=12 ),
    legend.position="none"
  ) +
  theme_minimal() +
  ylim(0,1) +
  ylab("") +
  xlab("")
```


<center>
  **`r name` Knowledge**
</center>
  
```{r}
mean_list_h %>% 
  ggplot( aes(x=Question, y=Mean)) +
  geom_segment( aes(x=Question ,xend=Question, y=0, yend=Mean), color="grey") +
  geom_point(size=5, color="#69b3a2") +
  coord_flip() +
  theme(
    panel.grid.minor.y = element_blank(),
    panel.grid.major.y = element_blank(),
    axis.text = element_text( size=12 ),
    legend.position="none"
  ) +
  theme_minimal() +
  ylim(0,1) +
  ylab("") +
  xlab("")
```






