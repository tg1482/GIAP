---
output:
  html_document:
    theme: cosmo
always_allow_html: yes
bibliography: bibliography.bib
nocite: | 
  @author1, @author2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, comment=NA, fig.width = 6, fig.asp = 0.618,
                      out.width = "80%", fig.align = "center", fig.show='hold')
```

```{r initialize}
hospital_names <- unique(giap$`Hospital.Name`)[!is.na(unique(giap$`Hospital.Name`))]

id <- unique(giap$Hospital.ID[giap$Hospital.Name==name] %>% na.omit())
```

```{r, fig.align = "left", out.width='15%'}
knitr::include_graphics("NICHE_logo.jpg")
```


<center>
# **Nurses Improving Care for Healthsystem Elders**
## **Geriatric Institutional Assessment Profile Report**
### **February 2019 Cohort**
</center>

#### **`r name`**
**GIAP Overview**

The Geriatric Institutional Assessment Profile (GIAP) is a baseline assessment of nurses' knowledge, skills, attitudes and perceptions regarding care for older adults. The information generated from the GIAP is used to identify strengths and prioritize opportunities to improve nursing practice to support clinical excellence in the care of older adults.     

The GIAP (v.8) provides clinical leaders with information about nurses' perceptions regarding:     

* Knowledge to identify and manage the geriatric syndromes 
* Availability of specialized resource to care for older adults
* Age-friendly care planning and delivery 
* Organizational values regarding care of older adults 
* Unit environment to support NICHE program implementation
  
**How to Use the GIAP Results to Improve Nursing Care for Older Adults**

The results are reported in two sections. The first section summarizes nurses' knowledge about the geriatric syndromes of delirium, falls, pressure injuries, and incontinence and the nursing problems of pain, nutrition and hydration, restraint use, and managing behaviors associated with dementia and cognitive decline. The second section summarizes nurses' views about the unit environment to support age-friendly care.

We use the quality improvement convention of the red, yellow and green stop light colors to present the GIAP results. Where applicable, the mean score for the cohort and your hospital are marked with an asterisks (*). As you review the diagrams, yellow and green denote higher performance on each measure.   

Following the generally accepted nursing education standards, a mean score of 80% demonstrates mastery of clinical knowledge required to identify and manage the common clinical conditions experienced by older adults. Drawing on insights from organizational change, we recommend that approximately 75% of nurses on the units involved in the NICHE initiative at your hospital will agree or strongly agree that they have access to the necessary clinical and organizational resources to support the delivery of age-friendly care on their units. 

In the final section of this report, we offer recommendations for how to use the GIAP results to guide NICHE implementation efforts at your hospital.

<center>
#### **Nurse Characteristics**
</center>

**Participants:** The data included in this report were collected between `r min(lubridate::month(giap$startDate,label = TRUE))`-`r min(lubridate::year(giap$startDate))` and `r max(lubridate::month(giap$startDate,label = TRUE))`-`r max(lubridate::year(giap$startDate))`.  A total of `r nrow(giap %>% filter(Hospital.Name==name))` nurses at `r name` provided compete data for the questions included in this report. The demographic characteristics for the participating nursing staff from `r name` are summarized in the following tables.

```{r}
giap %>%
  filter(!is.na(Q21))%>%
  rename(Gender = Q21) %>%
  count(Gender) %>%
  mutate(n = round(n / sum(n) * 100, 1),
         Gender = case_when(Gender == 1 ~ "Male",
                            Gender == 2 ~ "Female",
                            Gender == 3 ~ "Prefer not to Report",
                            Gender == 9 ~ "Prefer not to Report"),
         Gender = factor(Gender, levels = c("Prefer not to Report", "Male", "Female"))) %>%
  arrange(desc(n)) %>% 
  full_join(giap %>%
              filter(Hospital.Name ==name, !is.na(Q21)) %>%
              rename(Gender = Q21) %>%
              count(Gender) %>%
              mutate(n = round(n / sum(n) * 100, 1),
                     Gender = case_when(Gender == 1 ~ "Male",
                                        Gender == 2 ~ "Female",
                                        Gender == 3 ~ "Prefer not to Report",
                                        Gender == 9 ~ "Prefer not to Report"),
                     Gender = factor(Gender, levels = c("Prefer not to Report", "Male", "Female"))),
            by = "Gender") %>%
  setNames(c("Gender", "Cohort (%)", "Hospital (%)")) %>%     
  mutate_if(is.numeric, na_to_zero) %>% 
  kable(format = "html", table.attr = "style='width:90%;'") %>% 
  kable_styling() %>% 
  column_spec(1, width = "30em") %>%
  column_spec(2, width = "10em") %>% 
  column_spec(3, width = "10em")
```


```{r}
giap %>%
  filter(!is.na(Q22), Q22 ==1) %>%
  mutate(Q22 = case_when(Q22 == 1 ~ "Hispanic or Latino/Latina")) %>% 
  rename(Ethnicity = Q22) %>% 
  count(Ethnicity)%>% 
  rbind({giap %>%
      filter(!is.na(Q23_1), Q23_1 ==1) %>%
      mutate(Q23_1 = case_when(Q23_1 == 1 ~ "American Indian or Alaskan Native")) %>% 
      rename(`Ethnicity` = Q23_1) %>% 
      count(Ethnicity)}) %>% 
  rbind({giap %>%
      filter(!is.na(Q23_2), Q23_2 ==1) %>%
      mutate(Q23_2 = case_when(Q23_2 == 1 ~ "Asian")) %>% 
      rename(`Ethnicity` = Q23_2) %>%
      count(`Ethnicity`)}) %>% 
  rbind({giap %>%
      filter(!is.na(Q23_3), Q23_3 ==1) %>%
      mutate(Q23_3 = case_when(Q23_3 == 1 ~ "Black or African American")) %>% 
      rename(`Ethnicity` = Q23_3) %>%
      count(`Ethnicity`)}) %>% 
  rbind({giap %>%
      filter(!is.na(Q23_4), Q23_4==1) %>%
      mutate(Q23_4 = case_when(Q23_4 == 1 ~ "Native Hawaiian or Pacific Islander")) %>% 
      rename(`Ethnicity` = Q23_4) %>%
      count(`Ethnicity`)}) %>% 
  rbind({giap %>%
      filter(!is.na(Q23_5), Q23_5==1) %>%
      mutate(Q23_5 = case_when(Q23_5 == 1 ~ "White")) %>% 
      rename(`Ethnicity` = Q23_5) %>%
      count(`Ethnicity`)}) %>% 
  rbind({giap %>%
      filter(!is.na(Q23_6), Q23_6==1) %>%
      mutate(Q23_6 = case_when(Q23_6 == 1 ~ "Other")) %>% 
      rename(`Ethnicity` = Q23_6) %>%
      count(`Ethnicity`)}) %>% 
  {.[order(.$n, decreasing = T),]} %>% 
  rbind(c("Ethnicity" = "Prefer Not to Report", 
          "n" = nrow(giap %>% 
                       filter((Q23_1==9&Q23_2==9&Q23_3==9&Q23_4==9&Q23_5==9&Q23_6==9) |
                                (Q23_1==0&Q23_2==0&Q23_3==0&Q23_4==0&Q23_5==0&Q23_6==0))))) %>% 
  mutate(n = as.numeric(n),
         n = round(n / sum(n) * 100, 1)) %>% 
  rename(Count = n) %>% 
  full_join(giap %>%
  filter(Hospital.Name ==name,!is.na(Q22), Q22 ==1) %>%
  mutate(Q22 = case_when(Q22 == 1 ~ "Hispanic or Latino/Latina")) %>% 
  rename(Ethnicity = Q22) %>% 
  count(Ethnicity)%>% 
  rbind({giap %>%
      filter(Hospital.Name ==name,!is.na(Q23_1), Q23_1 ==1) %>%
      mutate(Q23_1 = case_when(Q23_1 == 1 ~ "American Indian or Alaskan Native")) %>% 
      rename(`Ethnicity` = Q23_1) %>% 
      count(Ethnicity)}) %>% 
  rbind({giap %>%
      filter(Hospital.Name ==name,!is.na(Q23_2), Q23_2 ==1) %>%
      mutate(Q23_2 = case_when(Q23_2 == 1 ~ "Asian")) %>% 
      rename(`Ethnicity` = Q23_2) %>%
      count(`Ethnicity`)}) %>% 
  rbind({giap %>%
      filter(Hospital.Name ==name,!is.na(Q23_3), Q23_3 ==1) %>%
      mutate(Q23_3 = case_when(Q23_3 == 1 ~ "Black or African American")) %>% 
      rename(`Ethnicity` = Q23_3) %>%
      count(`Ethnicity`)}) %>% 
  rbind({giap %>%
      filter(Hospital.Name ==name,!is.na(Q23_4), Q23_4==1) %>%
      mutate(Q23_4 = case_when(Q23_4 == 1 ~ "Native Hawaiian or Pacific Islander")) %>% 
      rename(`Ethnicity` = Q23_4) %>%
      count(`Ethnicity`)}) %>% 
  rbind({giap %>%
      filter(Hospital.Name ==name,!is.na(Q23_5), Q23_5==1) %>%
      mutate(Q23_5 = case_when(Q23_5 == 1 ~ "White")) %>% 
      rename(`Ethnicity` = Q23_5) %>%
      count(`Ethnicity`)}) %>% 
  rbind({giap %>%
      filter(Hospital.Name ==name,!is.na(Q23_6), Q23_6==1) %>%
      mutate(Q23_6 = case_when(Q23_6 == 1 ~ "Other")) %>% 
      rename(`Ethnicity` = Q23_6) %>%
      count(`Ethnicity`)}) %>% 
  {.[order(.$n, decreasing = T),]} %>% 
  rbind(c("Ethnicity" = "Prefer Not to Report", 
          "n" = nrow(giap %>% filter(Hospital.Name==name & 
                   ((Q23_1==9 & Q23_2==9& Q23_3==9& Q23_4==9& Q23_5==9 & Q23_6==9) | 
                      (Q23_1==0 & Q23_2==0& Q23_3==0& Q23_4==0& Q23_5==0 & Q23_6==0)))))) %>% 
  mutate(n = as.numeric(n),
         n = round(n / sum(n) * 100, 1)) %>% 
  rename(Count = n), by = "Ethnicity") %>% 
  mutate_if(is.numeric, na_to_zero) %>% 
  setNames(c("Ethnicity", "Cohort (%)", "Hospital (%)")) %>% 
  kable(format = "html", table.attr = "style='width:90%;'") %>% 
  kable_styling() %>% 
  column_spec(1, width = "30em") %>%
  column_spec(2, width = "10em") %>% 
  column_spec(3, width = "10em")
```


```{r}
giap %>% 
  select(Q2) %>% 
  mutate(Cat = case_when(Q2 <= 1 ~ 1,
                         Q2 > 1 & Q2 <= 5 ~ 2,
                         Q2 > 5 & Q2 <= 10 ~ 3,
                         Q2 > 10 & Q2 <= 15 ~ 4,
                         Q2 > 15 & Q2 <= 20 ~ 5,
                         Q2 > 20 & Q2 < 40 ~ 6,
                         Q2 >= 40 & Q2 < 80 ~ 7,
                         is.na(Q2) ~ 8,
                         Q2 == 99 ~ 8),
         Term = case_when(Cat == 1 ~ "Less than 1 year",
                          Cat == 2 ~ "Between 1 and 5 years",
                          Cat == 3 ~ "Between 5 and 10 years",
                          Cat == 4 ~ "Between 10 and 15 years",
                          Cat == 5 ~ "Between 15 and 20 years",
                          Cat == 6 ~ "Between 20 and 40 years",
                          Cat == 7 ~ "40 and above",
                          Cat == 8 ~ "Prefer Not to Report")) %>% 
  group_by(Term, Cat) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  arrange(Cat) %>% 
  rename(Experience = Term) %>% 
  select(-Cat) %>%
  full_join(giap %>% 
  filter(Hospital.Name == name) %>% 
  select(Q2) %>% 
  mutate(Cat = case_when(Q2 <= 1 ~ 1,
                         Q2 > 1 & Q2 <= 5 ~ 2,
                         Q2 > 5 & Q2 <= 10 ~ 3,
                         Q2 > 10 & Q2 <= 15 ~ 4,
                         Q2 > 15 & Q2 <= 20 ~ 5,
                         Q2 > 20 & Q2 < 40 ~ 6,
                         Q2 >= 40 & Q2 < 80 ~ 7,
                         is.na(Q2) ~ 8,
                         Q2 == 99 ~ 8),
         Term = case_when(Cat == 1 ~ "Less than 1 year",
                          Cat == 2 ~ "Between 1 and 5 years",
                          Cat == 3 ~ "Between 5 and 10 years",
                          Cat == 4 ~ "Between 10 and 15 years",
                          Cat == 5 ~ "Between 15 and 20 years",
                          Cat == 6 ~ "Between 20 and 40 years",
                          Cat == 7 ~ "40 and above",
                          Cat == 8 ~ "Prefer Not to Report")) %>% 
  group_by(Term, Cat) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  arrange(Cat) %>% 
  rename(Experience = Term) %>% 
  select(-Cat), by = "Experience") %>%
  mutate_if(is.numeric, na_to_zero) %>%
  setNames(c("Years of Practice Experience", "Cohort (%)", "Hospital (%)")) %>%    
  as.data.frame() %>% 
  kable(format = "html", table.attr = "style='width:90%;'") %>% 
  kable_styling() %>% 
  column_spec(1, width = "30em") %>%
  column_spec(2, width = "10em") %>% 
  column_spec(3, width = "10em")
```

```{r}
giap %>% 
  select(Q3) %>% 
  mutate(Cat = case_when(Q3 <= 1 ~ 1,
                         Q3 > 1 & Q3 <= 5 ~ 2,
                         Q3 > 5 & Q3 <= 10 ~ 3,
                         Q3 > 10 & Q3 <= 15 ~ 4,
                         Q3 > 15 & Q3 <= 20 ~ 5,
                         Q3 > 20 & Q3 < 40 ~ 6,
                         Q3 >= 40 & Q3 < 80 ~ 7,
                         is.na(Q3) ~ 8,
                         Q3 == 99 ~ 8),
         Term = case_when(Cat == 1 ~ "Less than 1 year",
                          Cat == 2 ~ "Between 1 and 5 years",
                          Cat == 3 ~ "Between 5 and 10 years",
                          Cat == 4 ~ "Between 10 and 15 years",
                          Cat == 5 ~ "Between 15 and 20 years",
                          Cat == 6 ~ "Between 20 and 40 years",
                          Cat == 7 ~ "40 and above",
                          Cat == 8 ~ "Prefer Not to Report")) %>% 
  group_by(Term, Cat) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  arrange(Cat) %>% 
  rename(Experience = Term) %>% 
  select(-Cat) %>%
  full_join(giap %>% 
  filter(Hospital.Name == name) %>% 
  select(Q3) %>% 
  mutate(Cat = case_when(Q3 <= 1 ~ 1,
                         Q3 > 1 & Q3 <= 5 ~ 2,
                         Q3 > 5 & Q3 <= 10 ~ 3,
                         Q3 > 10 & Q3 <= 15 ~ 4,
                         Q3 > 15 & Q3 <= 20 ~ 5,
                         Q3 > 20 & Q3 < 40 ~ 6,
                         Q3 >= 40 & Q3 < 80 ~ 7,
                         is.na(Q3) ~ 8,
                         Q3 == 99 ~ 8),
         Term = case_when(Cat == 1 ~ "Less than 1 year",
                          Cat == 2 ~ "Between 1 and 5 years",
                          Cat == 3 ~ "Between 5 and 10 years",
                          Cat == 4 ~ "Between 10 and 15 years",
                          Cat == 5 ~ "Between 15 and 20 years",
                          Cat == 6 ~ "Between 20 and 40 years",
                          Cat == 7 ~ "40 and above",
                          Cat == 8 ~ "Prefer Not to Report")) %>% 
  group_by(Term, Cat) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  arrange(Cat) %>% 
  rename(Experience = Term) %>% 
  select(-Cat), by = "Experience") %>%
  mutate_if(is.numeric, na_to_zero) %>%
  setNames(c("Years working for Employer", "Cohort (%)", "Hospital (%)")) %>%    
  as.data.frame() %>% 
  kable(format = "html", table.attr = "style='width:90%;'") %>% 
  kable_styling() %>% 
  column_spec(1, width = "30em") %>%
  column_spec(2, width = "10em") %>% 
  column_spec(3, width = "10em")
```

```{r}
giap %>%
  rename(GRN = Q40) %>%
  count(GRN) %>%
  mutate(Percent = round(n / sum(n) * 100, 1),
         GRN = case_when(GRN == 1 ~ "Yes",
                         GRN == 2 ~ "No",
                         GRN == 9 ~ "Prefer not to Report",
                         is.na(GRN) ~ "Prefer not to Report"),
         GRN = factor(GRN, levels = c("Prefer not to Report", "No", "Yes"))) %>%
  select(-n) %>% 
  full_join(giap %>%
              filter(Hospital.Name ==name) %>%
              rename(GRN = Q40) %>%
              count(GRN) %>%
              mutate(Percent = round(n / sum(n) * 100, 1),
                     GRN = case_when(GRN == 1 ~ "Yes",
                                     GRN == 2 ~ "No",
                                     GRN == 9 ~ "Prefer not to Report",
                                     is.na(GRN) ~ "Prefer not to Report"),
                     GRN = factor(GRN, levels = c("Prefer not to Report", "No", "Yes"))) %>%
              #arrange(desc(n)) %>% 
              select(-n), by = "GRN") %>%
  setNames(c("Completed NICHE GRN Program", "Cohort (%)", "Hospital (%)")) %>%     
  mutate_if(is.numeric, na_to_zero) %>%
  kable(format = "html", table.attr = "style='width:90%;'") %>% 
  kable_styling() %>% 
  column_spec(1, width = "30em") %>%
  column_spec(2, width = "10em") %>% 
  column_spec(3, width = "10em")
```

```{r}
giap %>%
  rename(Enroll = Q25) %>%
  count(Enroll) %>%
  mutate(Percent = round(n / sum(n) * 100, 1),
         Enroll = case_when(Enroll == 1 ~ "Yes, full-time",
                         Enroll == 2 ~ "Yes, part-time",
                         Enroll == 3 ~ "No",
                         Enroll == -1 ~ "Prefer not to Report",
                         Enroll == 9 ~ "Prefer not to Report",
                         is.na(Enroll) ~ "Prefer not to Report"),
         Enroll = factor(Enroll, levels = c("Prefer not to Report", "No", "Yes, part-time", "Yes, full-time"))) %>%
  select(-n) %>% 
  full_join(giap %>%
              filter(Hospital.Name ==name) %>%
              rename(Enroll = Q25) %>%
              count(Enroll) %>%
              mutate(Percent = round(n / sum(n) * 100, 1),
                     Enroll = case_when(Enroll == 1 ~ "Yes, full-time",
                         Enroll == 2 ~ "Yes, part-time",
                         Enroll == 3 ~ "No",
                         Enroll == -1 ~ "Prefer not to Report",
                         Enroll == 9 ~ "Prefer not to Report",
                         is.na(Enroll) ~ "Prefer not to Report"),
                     Enroll = factor(Enroll, levels = c("Prefer not to Report", "No", "Yes, part-time", "Yes, full-time")))%>%
              #arrange(desc(n)) %>% 
              select(-n), by = "Enroll") %>%
  setNames(c("Enrolled in Formal Nursing Education Program", "Cohort (%)", "Hospital (%)")) %>%     
  mutate_if(is.numeric, na_to_zero) %>%
  kable(format = "html", table.attr = "style='width:90%;'") %>% 
  kable_styling() %>% 
  column_spec(1, width = "30em") %>%
  column_spec(2, width = "10em") %>% 
  column_spec(3, width = "10em")
```

```{r}
giap %>%
  rename(NATLCERT = Q26) %>%
  count(NATLCERT) %>%
  mutate(Percent = round(n / sum(n) * 100, 1),
         NATLCERT = case_when(NATLCERT == 1 ~ "Yes",
                         NATLCERT == 2 ~ "No",
                         NATLCERT == 9 ~ "Prefer not to Report",
                         is.na(NATLCERT) ~ "Prefer not to Report"),
         NATLCERT = factor(NATLCERT, levels = c("Prefer not to Report", "No", "Yes"))) %>%
  select(-n) %>% 
  full_join(giap %>%
              filter(Hospital.Name ==name) %>%
              rename(NATLCERT = Q26) %>%
              count(NATLCERT) %>%
              mutate(Percent = round(n / sum(n) * 100, 1),
                     NATLCERT = case_when(NATLCERT == 1 ~ "Yes",
                                     NATLCERT == 2 ~ "No",
                                     NATLCERT == 9 ~ "Prefer not to Report",
                                     is.na(NATLCERT) ~ "Prefer not to Report"),
                     NATLCERT = factor(NATLCERT, levels = c("Prefer not to Report", "No", "Yes"))) %>%
              #arrange(desc(n)) %>% 
              select(-n), by = "NATLCERT") %>%
  setNames(c("Completed National Specialty Certification and/or Nurse Practitioner Certification", "Cohort (%)", "Hospital (%)")) %>%     
  mutate_if(is.numeric, na_to_zero) %>%
  kable(format = "html", table.attr = "style='width:90%;'") %>% 
  kable_styling() %>% 
  column_spec(1, width = "30em") %>%
  column_spec(2, width = "10em") %>% 
  column_spec(3, width = "10em")
```

```{r}
giap %>%
  rename(NATLCERT = Q27) %>%
  count(NATLCERT) %>%
  mutate(Percent = round(n / sum(n) * 100, 1),
         NATLCERT = case_when(NATLCERT == 1 ~ "Yes",
                         NATLCERT == 2 ~ "No",
                         NATLCERT == 9 ~ "Prefer not to Report",
                         is.na(NATLCERT) ~ "Prefer not to Report"),
         NATLCERT = factor(NATLCERT, levels = c("Prefer not to Report", "No", "Yes"))) %>%
  select(-n) %>% 
  full_join(giap %>%
              filter(Hospital.Name ==name) %>%
              rename(NATLCERT = Q27) %>%
              count(NATLCERT) %>%
              mutate(Percent = round(n / sum(n) * 100, 1),
                     NATLCERT = case_when(NATLCERT == 1 ~ "Yes",
                                     NATLCERT == 2 ~ "No",
                                     NATLCERT == 9 ~ "Prefer not to Report",
                                     is.na(NATLCERT) ~ "Prefer not to Report"),
                     NATLCERT = factor(NATLCERT, levels = c("Prefer not to Report", "No", "Yes"))) %>%
              #arrange(desc(n)) %>% 
              select(-n), by = "NATLCERT") %>%    
  setNames(c("Completed National Specialty Certification in Gerontological Nursing",
             "Cohort (%)", "Hospital (%)")) %>%     
  mutate_if(is.numeric, na_to_zero) %>%
  kable(format = "html", table.attr = "style='width:90%;'") %>% 
  kable_styling() %>% 
  column_spec(1, width = "30em") %>%
  column_spec(2, width = "10em") %>% 
  column_spec(3, width = "10em")
```

```{r}
giap %>% 
  select(Q30) %>% 
  mutate(Q30 = ifelse(is.na(Q30), 9, Q30),
         Degree = case_when(Q30 == 1 ~ "Diploma",
                            Q30 == 2 ~ "Associate Degree",
                            Q30 == 3 ~ "Baccalaureate Degree",
                            Q30 == 4 ~ "Master Degree",
                            Q30 == 5 ~ "Doctorate",
                            Q30 == 6 ~ "I am not a registered nurse",
                            Q30 == 9 ~ "Prefer not to Report")) %>% 
  group_by(Q30, Degree) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  select(-Q30) %>% 
  full_join(giap %>% 
  filter(Hospital.Name == name) %>% 
  select(Q30) %>% 
  mutate(Q30 = ifelse(is.na(Q30), 9, Q30),
         Degree = case_when(Q30 == 1 ~ "Diploma",
                            Q30 == 2 ~ "Associate Degree",
                            Q30 == 3 ~ "Baccalaureate Degree",
                            Q30 == 4 ~ "Master Degree",
                            Q30 == 5 ~ "Doctorate",
                            Q30 == 6 ~ "I am not a registered nurse",
                            Q30 == 9 ~ "Prefer not to Report")) %>% 
  group_by(Q30, Degree) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  select(-Q30), by = "Degree") %>% 
  mutate_if(is.numeric, na_to_zero) %>%
  setNames(c("Education", "Cohort (%)", "Hospital (%)")) %>%    
  as.data.frame() %>% 
  kable(format = "html", table.attr = "style='width:90%;'") %>% 
  kable_styling() %>% 
  column_spec(1, width = "30em") %>%
  column_spec(2, width = "10em") %>% 
  column_spec(3, width = "10em")
```

```{r}
giap %>% 
  select(Q35) %>% 
  mutate(Q35 = ifelse(is.na(Q35), 9, Q35),
         Shift = case_when(Q35 == 1 ~ "8-hour shifts",
                            Q35 == 2 ~ "10-hour shifts",
                            Q35 == 3 ~ "12-hour shifts",
                            Q35 == 4 ~ "Flexible Schedule",
                            Q35 == 5 ~ "Other",
                            Q35 == 9 ~ "Did not Answer")) %>% 
  group_by(Shift, Q35) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  arrange(Q35) %>%
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  select(-Q35) %>% 
  full_join(giap %>% 
  filter(Hospital.Name == name) %>% 
  select(Q35) %>% 
  mutate(Q35 = ifelse(is.na(Q35), 9, Q35),
         Shift = case_when(Q35 == 1 ~ "8-hour shifts",
                            Q35 == 2 ~ "10-hour shifts",
                            Q35 == 3 ~ "12-hour shifts",
                            Q35 == 4 ~ "Flexible Schedule",
                            Q35 == 5 ~ "Other",
                            Q35 == 9 ~ "Did not Answer")) %>% 
  group_by(Shift, Q35) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  arrange(Q35) %>%
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  select(-Q35), by = "Shift") %>% 
  mutate_if(is.numeric, na_to_zero) %>%
  setNames(c("Shift Length", "Cohort (%)", "Hospital (%)")) %>%    
  as.data.frame() %>% 
  kable(format = "html", table.attr = "style='width:90%;'") %>% 
  kable_styling() %>% 
  column_spec(1, width = "30em") %>%
  column_spec(2, width = "10em") %>% 
  column_spec(3, width = "10em")
```

```{r}
giap %>% 
  select(Q36) %>% 
  mutate(Q36 = ifelse(is.na(Q36), 9, Q36),
         Work = case_when(Q36 == 1 ~ "Day",
                            Q36 == 2 ~ "Evening",
                            Q36 == 3 ~ "Night",
                            Q36 == 4 ~ "Rotating Schedule",
                            Q36 == 9 ~ "Did not Answer")) %>% 
  group_by(Work, Q36) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  arrange(Q36) %>% 
  select(-Q36) %>% 
  full_join(giap %>% 
  filter(Hospital.Name == name) %>% 
  select(Q36) %>% 
  mutate(Q36 = ifelse(is.na(Q36), 9, Q36),
         Work = case_when(Q36 == 1 ~ "Day",
                            Q36 == 2 ~ "Evening",
                            Q36 == 3 ~ "Night",
                            Q36 == 4 ~ "Rotating Schedule",
                            Q36 == 9 ~ "Did not Answer")) %>% 
  group_by(Work, Q36) %>% 
  summarise(Count = n()) %>% 
  ungroup() %>% 
  mutate(Count = round(Count / sum(Count) * 100, 1)) %>% 
  arrange(Q36) %>% 
  select(-Q36), by = "Work") %>% 
  mutate_if(is.numeric, na_to_zero) %>%
  setNames(c("Work Schedule", "Cohort (%)", "Hospital (%)")) %>%    
  as.data.frame() %>% 
  kable(format = "html", table.attr = "style='width:90%;'") %>% 
  kable_styling() %>% 
  column_spec(1, width = "30em") %>%
  column_spec(2, width = "10em") %>% 
  column_spec(3, width = "10em") 
```


**This diagram depicts the extent to which the participating nurses are satisfied with their job.**

<center>
**Cohort**
</center>

```{r, fig.height=1, fig.width=9, fig.asp = .15, out.width = "95%"}
cols <- c("Strongly Disagree" = "#AE6180",
          "Disagree" = "#AE6180",
          "Neither agree nor disagree" = "#A3A9AC", 
          "Agree" = "#FFC842", 
          "Strongly Agree" = "#6BAB8A")

graph_data_score <- giap %>%
  filter(!is.na(Q32), Q32!=9) %>%
  rename(`Response` = Q32) %>%
  count(`Response`) %>%
  mutate(Percent = round(n / sum(n), 2),
         Item = "I am satisfied with my current job",
         Response_N = case_when(Response == 5 ~ "Disagree",
                           Response == 4 ~ "Disagree",
                           Response == 3 ~ "Neither agree nor disagree",
                           Response == 2 ~ "Agree",
                           Response == 1 ~ "Strongly Agree"),
         Response_N = ordered(Response_N, levels = rev(c("Disagree",
                                                     "Neither agree nor disagree",
                                                     "Agree",
                                                     "Strongly Agree"))),
         Score = case_when(Response == 5 ~ 1,
                           Response == 4 ~ 2,
                           Response == 3 ~ 3,
                           Response == 2 ~ 4,
                           Response == 1 ~ 5),
         Score = Score*n)

graph_data <- aggregate(n ~ Response_N, FUN = sum, graph_data_score) %>% 
  mutate(Item = "I am satisfied with my current job")
  
graph_data %>% 
  ggplot(aes(x = (Item), y = n, fill = Response_N)) +
  geom_bar(position = "fill", stat = "identity", width = .8, color = "white") +
  geom_point(aes(x = (Item), y = sum(Score)/(5*(sum(n)))), 
             shape = 8, 
             size = 1.5, 
             show.legend = FALSE, 
             stroke = 0.5, 
             data = graph_data_score) +
  scale_y_continuous(labels = percent_format()) +
  scale_fill_manual(values = cols) +
  labs(y = "", x = "", fill = "") +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "right", 
        axis.ticks.y = element_blank(), 
        panel.border = element_blank())
```

<center>
**`r name`**
</center>

```{r, fig.height=1, fig.width=9, fig.asp = .15, out.width = "95%"}
graph_data_score <- giap %>%
  filter(!is.na(Q32), Q32!=9, Hospital.Name==name) %>%
  rename(`Response` = Q32) %>%
  count(`Response`) %>%
  mutate(Percent = round(n / sum(n), 2),
         Item = "I am satisfied with my current job",
         Response_N = case_when(Response == 5 ~ "Disagree",
                           Response == 4 ~ "Disagree",
                           Response == 3 ~ "Neither agree nor disagree",
                           Response == 2 ~ "Agree",
                           Response == 1 ~ "Strongly Agree"),
         Response_N = ordered(Response_N, levels = rev(c("Disagree",
                                                     "Neither agree nor disagree",
                                                     "Agree",
                                                     "Strongly Agree"))),
         Score = case_when(Response == 5 ~ 1,
                           Response == 4 ~ 2,
                           Response == 3 ~ 3,
                           Response == 2 ~ 4,
                           Response == 1 ~ 5),
         Score = Score*n)

graph_data <- aggregate(n ~ Response_N, FUN = sum, graph_data_score) %>% 
  mutate(Item = "I am satisfied with my current job")
  
graph_data %>% 
  ggplot(aes(x = (Item), y = n, fill = Response_N)) +
  geom_bar(position = "fill", stat = "identity", width = .8, color = "white") +
  geom_point(aes(x = (Item), y = sum(Score)/(5*(sum(n)))), 
             shape = 8, 
             size = 1.5, 
             show.legend = FALSE, 
             stroke = 0.5, 
             data = graph_data_score) +
  scale_y_continuous(labels = percent_format()) +
  scale_fill_manual(values = cols) +
  labs(y = "", x = "", fill = "") +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "right", 
        axis.ticks.y = element_blank(), 
        panel.border = element_blank())
```

**This diagram depicts the extent to which the participating nurses find their work with older adults to be rewarding**

<center>
**Cohort**
</center>

```{r, fig.height=1, fig.width=9, fig.asp = .15, out.width = "95%"}
wrap_35 <- wrap_format(35)

cols <- c("Not rewarding" = "#AE6180",
          "Neutral" = "#A3A9AC", 
          "Somewhat rewarding" = "#FFC842", 
          "Very rewarding" = "#6BAB8A")

graph_data <- giap %>%
  filter(!is.na(Q12), Q12 != 9) %>%
  rename(`Response` = Q12) %>%
  count(`Response`) %>%
  mutate(Percent = round(n / sum(n), 2),
         Item = "How rewarding is your work with older adults",
         Response_N = case_when(Response == 4 ~ "Not rewarding",
                           Response == 3 ~ "Neutral",
                           Response == 2 ~ "Somewhat rewarding",
                           Response == 1 ~ "Very rewarding"),
         Response_N = ordered(Response_N, levels = rev(c("Not rewarding",
                                                     "Neutral",
                                                     "Somewhat rewarding",
                                                     "Very rewarding"))),
         Score = case_when(Response == 4 ~ 1,
                           Response == 3 ~ 2,
                           Response == 2 ~ 3,
                           Response == 1 ~ 4),
         Score = Score*n)

graph_data %>% 
  ggplot(aes(x = wrap_35(Item), y = n, fill = Response_N)) +
  geom_bar(position = "fill", stat = "identity", width = .8, color = "white") +
  geom_point(aes(x = wrap_35(Item), y = sum(Score)/(4*(sum(n)))), shape = 8, size = 1.5, show.legend = FALSE, stroke = 0.5 ) +
  scale_y_continuous(labels = percent_format()) +
  scale_fill_manual(values = cols) +
  labs(y = "", x = "", fill = "") +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "right", 
        axis.ticks.y = element_blank(), 
        panel.border = element_blank())
```

<center>
**`r name`**
</center>

```{r, fig.height=1, fig.width=9, fig.asp = .15, out.width = "95%"}
graph_data <- giap %>%
  filter(!is.na(Q12), Q12 != 9, Hospital.Name==name) %>%
  rename(`Response` = Q12) %>%
  count(`Response`) %>%
  mutate(Percent = round(n / sum(n), 2),
         Item = "How rewarding is your work with older adults",
         Response_N = case_when(Response == 4 ~ "Not rewarding",
                           Response == 3 ~ "Neutral",
                           Response == 2 ~ "Somewhat rewarding",
                           Response == 1 ~ "Very rewarding"),
         Response_N = ordered(Response_N, levels = rev(c("Not rewarding",
                                                     "Neutral",
                                                     "Somewhat rewarding",
                                                     "Very rewarding"))),
         Score = case_when(Response == 4 ~ 1,
                           Response == 3 ~ 2,
                           Response == 2 ~ 3,
                           Response == 1 ~ 4),
         Score = Score*n)

graph_data %>% 
  ggplot(aes(x = wrap_35(Item), y = n, fill = Response_N)) +
  geom_bar(position = "fill", stat = "identity", width = .8, color = "white") +
  geom_point(aes(x = wrap_35(Item), y = sum(Score)/(4*(sum(n)))), shape = 8, size = 1.5, show.legend = FALSE, stroke = 0.5 ) +
  scale_y_continuous(labels = percent_format()) +
  scale_fill_manual(values = cols) +
  labs(y = "", x = "", fill = "") +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "right", 
        axis.ticks.y = element_blank(), 
        panel.border = element_blank())
```

<center>
#### **GIAP Results**
</center>

**Baseline Knowledge of the Geriatric Syndromes**

The following diagram illustrates nurses' knowledge of evidence-based interventions to manage common problems experienced by older adults. The results for the Spring 2018 cohort and `r name` are presented below. The mean score for the correct answer for each clinical condition included in the GIAP is marked with an asterisks (*). A mean score of 80% or higher reflects nurses' mastery of the clinical knowledge needed to effectively assess, diagnose, and manage the geriatric syndromes and common nursing problems experienced by older adults during hospitalization.  

```{r}
knowledge <- giap %>%
  select(Hospital.Name, CASEID, Q42b, Q43c, Q44c, Q45b, Q46b, Q51b, Q47a, Q48d, Q49c, 
         Q50b, Q58c, Q59b, Q52a, Q56b, Q53b, Q55c, Q54c, Q57b, Q60c, Q61b) %>% 
  mutate_at(vars("Q42b", "Q43c", "Q44c", "Q45b", "Q46b", "Q51b", "Q47a", "Q48d", "Q49c",
                 "Q50b", "Q58c", "Q59b", "Q52a", "Q56b", "Q53b", "Q55c", "Q54c", "Q57b", 
                 "Q60c", "Q61b"), na_to_zero) %>%
  mutate(Falls = 0,
         Falls = ifelse(as.numeric(Q42b) == 1, Falls + 1, Falls + 0),
         Falls = ifelse(as.numeric(Q43c) == 1, Falls + 1, Falls + 0),
         Skin = 0,
         Skin = ifelse(as.numeric(Q44c) == 1, Skin + 1, Skin + 0),
         Skin = ifelse(as.numeric(Q45b) == 1, Skin + 1, Skin + 0),
         Assess = 0,
         Assess = ifelse(as.numeric(Q46b) == 1, Assess + 1, Assess + 0),
         Assess = ifelse(as.numeric(Q51b) == 1, Assess + 1, Assess + 0),
         Delirium = 0,
         Delirium = ifelse(as.numeric(Q47a) == 1, Delirium + 1, Delirium + 0),
         Urinary = 0,
         Urinary = ifelse(as.numeric(Q48d) == 1, Urinary + 1, Urinary + 0),
         Urinary = ifelse(as.numeric(Q49c) == 1, Urinary + 1, Urinary + 0),
         Nutrition = 0,
         Nutrition = ifelse(as.numeric(Q59b) == 1, Nutrition + 1, Nutrition + 0),
         Nutrition = ifelse(as.numeric(Q50b) == 1, Nutrition + 1, Nutrition + 0),
         Nutrition = ifelse(as.numeric(Q58c) == 1, Nutrition + 1, Nutrition + 0),
         Sleep = 0,
         Sleep = ifelse(as.numeric(Q52a) == 1, Sleep + 1, Sleep + 0),
         Sleep = ifelse(as.numeric(Q56b) == 1, Sleep + 1, Sleep + 0),
         Dementia = 0,
         Dementia = ifelse(as.numeric(Q53b) == 1, Dementia + 1, Dementia + 0),
         Dementia = ifelse(as.numeric(Q55c) == 1, Dementia + 1, Dementia + 0),
         Medication = 0,
         Medication = ifelse(as.numeric(Q54c) == 1, Medication + 1, Medication + 0),
         Medication = ifelse(as.numeric(Q57b) == 1, Medication + 1, Medication + 0),
         Depression = 0,
         Depression = ifelse(as.numeric(Q60c) == 1, Depression + 1, Depression + 0),
         Depression = ifelse(as.numeric(Q61b) == 1, Depression + 1, Depression + 0),
         Total = Falls + Skin + Assess + Delirium + Urinary + Nutrition + Sleep + 
           Dementia + Medication + Depression)

NICHE_colors <- c("#57068C","#6199AE","#FFC842","#314383","#6BAB8A","#F09C5D")
```

```{r knowledge}
#######################
# Falls
#######################
falls_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Falls) %>% 
  mutate(Score = Falls/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Falls")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Falls") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question"))

Falls <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Falls_H = mean(Score))

falls_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Falls) %>% 
  mutate(Score = Falls/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Falls")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Falls") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question"))


#######################
# Skin
#######################
skin_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Skin) %>% 
  mutate(Score = Skin/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Skin")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Skin") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Skin <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Skin_H = mean(Score))

skin_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Skin) %>% 
  mutate(Score = Skin/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Skin")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Skin") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)

#######################
# Assess
#######################
assess_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Assess) %>% 
  mutate(Score = Assess/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Assess")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Assess") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Assess <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Assess_H = mean(Score))

assess_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Assess) %>% 
  mutate(Score = Assess/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Assess")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Assess") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)

#######################
# Delirium
#######################
delirium_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Delirium) %>% 
  mutate(Score = Delirium,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Delirium")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Delirium") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Delirium <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Delirium_H = mean(Score))

delirium_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Delirium) %>% 
  mutate(Score = Delirium,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Delirium")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Delirium") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)

#######################
# Urinary
#######################
urinary_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Urinary) %>% 
  mutate(Score = Urinary/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Urinary")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Urinary") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Urinary <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Urinary_H = mean(Score))

urinary_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Urinary) %>% 
  mutate(Score = Urinary/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Urinary")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Urinary") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)

#######################
# Nutrition
#######################
nutrition_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Nutrition) %>% 
  mutate(Score = Nutrition/3,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Nutrition")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Nutrition") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Nutrition <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Nutrition_H = mean(Score))

nutrition_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Nutrition) %>% 
  mutate(Score = Nutrition/3,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Nutrition")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Nutrition") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)

#######################
# Sleep
#######################
sleep_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Sleep) %>% 
  mutate(Score = Sleep/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Sleep")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Sleep") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Sleep <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Sleep_H = mean(Score))

sleep_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Sleep) %>% 
  mutate(Score = Sleep/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Sleep")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Sleep") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)

#######################
# Dementia
#######################
dementia_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Dementia) %>% 
  mutate(Score = Dementia/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Dementia")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Dementia") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Dementia <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Dementia_H = mean(Score))

dementia_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Dementia) %>% 
  mutate(Score = Dementia/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Dementia")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Dementia") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)

#######################
# Medication
#######################
medication_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Medication) %>% 
  mutate(Score = Medication/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Medication")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Medication") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Medication <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Medication_H = mean(Score))

medication_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Medication) %>% 
  mutate(Score = Medication/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Medication")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Medication") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)

#######################
# Depression
#######################
depression_all <- knowledge %>% 
  select(Hospital.Name, CASEID, Depression) %>% 
  mutate(Score = Depression/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Depression")

mean_list_all <- mean_temp$Score %>% 
  mean %>% 
  cbind("Depression") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_all)

Depression <- mean_temp %>% 
  select(Hospital.Name, Score) %>% 
  group_by(Hospital.Name) %>% 
  summarize(Depression_H = mean(Score))

depression_h <- knowledge %>% 
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Depression) %>% 
  mutate(Score = Depression/2,
         Grade = case_when(Score < .30 ~ "Poor",
                           Score >= .30 & Score < .70 ~ "Fair",
                           Score >= .70 ~ "Very Good"),
         Grade = ordered(Grade, levels = c("Poor","Fair","Very Good"))) %>% 
  ungroup() %>%
  {. ->> mean_temp} %>% 
  count(Grade) %>%
  mutate(Percent = round(n / sum(n) * 100),
         Question = "Depression")

mean_list_h <- mean_temp$Score %>% 
  mean %>% 
  cbind("Depression") %>% 
  data.frame() %>% 
  setNames(c("Mean", "Question")) %>%  
  rbind(mean_list_h)
```

<center>
**Cohort Knowledge**
</center>

```{r}
cols <- c("Poor" = "#AE6180", 
          "Fair" = "#A3A9AC", 
          "Very Good" = "#6BAB8A")

question_levels <- c("Assess", "Delirium", "Dementia", "Depression", "Falls", "Medication", "Nutrition", "Skin", "Sleep", "Urinary")

mean_list_all$Mean <- as.numeric(as.character(mean_list_all$Mean))

list(falls_all, skin_all, assess_all, delirium_all, urinary_all, nutrition_all, sleep_all, 
     dementia_all, medication_all, depression_all, mean_list_all) %>% 
  reduce(full_join) %>%
  mutate(Grade = ordered(Grade, 
                         levels = c("Very Good", "Fair", "Poor")),
         Question = ordered(Question, levels = rev(question_levels))) %>%
  ggplot(aes(x = Question, y = Percent/100, fill = Grade)) +
  geom_bar(position = "fill", stat = "identity", width = 0.06 * 11, color = "white") +
  geom_point(aes(x=Question, y=Mean), shape = 8, size = 1, show.legend = FALSE, stroke = 0.3) +
  scale_y_continuous(labels = percent_format()) +
  scale_fill_manual(values = cols) +
  labs(y = "", x = "", fill = "") +
  theme_minimal() +
  theme(legend.position = "right", 
        axis.text.x = element_text(size = 7),
        axis.text.y = element_text(size = 7)) +
  coord_flip()
```

<center>
  **`r name` Knowledge**
</center>
  
```{r}

mean_list_h$Mean <- as.numeric(as.character(mean_list_h$Mean))

list(falls_h, skin_h, assess_h, delirium_h, urinary_h, nutrition_h, sleep_h, 
     dementia_h, medication_h, depression_h, mean_list_h) %>% 
  reduce(full_join) %>%
  mutate(Grade = ordered(Grade, 
                         levels = c("Very Good", "Fair", "Poor")),
         Question = ordered(Question, levels = rev(question_levels))) %>%
  ggplot(aes(x = Question, y = Percent/100, fill = Grade)) +
  geom_bar(position = "fill", stat = "identity", width = 0.06 * 11, color = "white") +
  geom_point(aes(x=Question, y=Mean), shape = 8, size = 1, show.legend = FALSE, stroke = 0.3) +
  scale_y_continuous(labels = percent_format()) +
  scale_fill_manual(values = cols) +
  labs(y = "", x = "", fill = "") +
  theme_minimal() +
  theme(legend.position = "right", 
        axis.text.x = element_text(size = 7),
        axis.text.y = element_text(size = 7)) +
  coord_flip()
```

**This diagram depicts nurses' rating of organizational efforts to educate the workforce on the care of older adults.**

<center>
**Cohort Results**
</center>

```{r, fig.asp = .2, fig.width=14, out.width = "85%"}
wrap_15 <- wrap_format(15)
wrap_30 <- wrap_format(30)

cols <- c("Strongly Disagree" = "#474C4F",
          "Disagree" = "#AE6180", 
          "Neither Agree nor Disagree" = "#A3A9AC", 
          "Agree" = "#FFC842", 
          "Strongly Agree" = "#6BAB8A")

giap %>%
  select(Hospital.Name, CASEID, Q17) %>%
  gather(Item, Response, -Hospital.Name, -CASEID) %>% 
  filter(!is.na(Response), Response != 9) %>%
  mutate(Response = case_when(Response == 1 ~ "Strongly Disagree",
                              Response == 2 ~ "Disagree",
                              Response == 3 ~ "Neither Agree nor Disagree",
                              Response == 4 ~ "Agree",
                              Response == 5 ~ "Strongly Agree"),
         Response = ordered(Response, levels = rev(c("Strongly Disagree","Disagree","Neither Agree nor Disagree","Agree","Strongly Agree"))),
         Item = case_when(Item == "Q17" ~ "Job your institution has done educating staff about the care of the older adult")) %>% 
  count(Item, Response) %>%
  mutate(Item = wrap_30(Item)) %>% 
  ggplot(aes(x = Item, y = n, fill = Response)) +
  geom_bar(position = "fill", stat = "identity", width = .5, color = "white") +
  scale_y_continuous(labels = percent_format()) +
  scale_fill_manual(values = cols) +
  labs(y = "", x = "", fill = "") +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "right", 
        text = element_text(size = 20, color = "black"), 
        panel.border = element_blank())
```

<center>
**`r name` Results**
</center>

```{r, fig.asp = .2, fig.width=14, out.width = "85%"}
giap %>%
  filter(Hospital.Name == name) %>% 
  select(Hospital.Name, CASEID, Q17) %>%
  gather(Item, Response, -Hospital.Name, -CASEID) %>% 
  filter(!is.na(Response), Response != 9) %>%
  mutate(Response = case_when(Response == 1 ~ "Strongly Disagree",
                              Response == 2 ~ "Disagree",
                              Response == 3 ~ "Neither Agree nor Disagree",
                              Response == 4 ~ "Agree",
                              Response == 5 ~ "Strongly Agree"),
         Response = ordered(Response, levels = rev(c("Strongly Disagree","Disagree","Neither Agree nor Disagree","Agree","Strongly Agree"))),
         Item = case_when(Item == "Q17" ~ "Job your institution has done educating staff about the care of the older adult")) %>% 
  count(Item, Response) %>%
  mutate(Item = wrap_30(Item)) %>% 
  ggplot(aes(x = Item, y = n, fill = Response)) +
  geom_bar(position = "fill", stat = "identity", width = .5, color = "white") +
  scale_y_continuous(labels = percent_format()) +
  scale_fill_manual(values = cols) +
  labs(y = "", x = "", fill = "") +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "right", 
        text = element_text(size = 20, color = "black"), 
        panel.border = element_blank())
```


**Practice Environment**

This section of the GIAP focuses on nurses' perceptions of the nursing unit to support age-friendly care. A practice environment that supports the unique care needs of older adults is characterized by: 1) the availability of specialized equipment and professional expertise; 2) holistic and person-centered care planning and care delivery processes; and 3) organizational values that support age-friendly care by taking older adults' unique needs into account in the design and delivery of care. This section concludes with nurses' assessment of the time and priority that managers, and other clinical leaders, place on implementing changes to improve the care of older adults on their unit.  

**Age-Friendly Care Planning and Patient-Centered Care**

The following diagram illustrates nurses' perceptions regarding the organizational environment to provide nursing care tailored to the unique needs of older adults.

<center>
**Cohort Level**
</center>

```{r,fig.width=13, fig.asp=.4}
cols <- c("Strongly Disagree" = "#474C4F",
          "Disagree" = "#AE6180",
          "Neither Agree nor Disagree" = "#A3A9AC", 
          "Agree" = "#FFC842", 
          "Strongly Agree" = "#6BAB8A")

giap %>%
  select(Q7_1, Q7_2, Q7_5, Q7_7, Q7_11, Q7_13) %>%
  gather(Item, Response) %>% 
  count(Item, Response) %>%
  filter(!is.na(Response), Response != 9) %>%
  mutate(Response = case_when(Response == 1 ~ "Strongly Disagree",
                              Response == 2 ~ "Disagree",
                              Response == 3 ~ "Neither Agree nor Disagree",
                              Response == 4 ~ "Agree",
                              Response == 5 ~ "Strongly Agree"),
         Response = ordered(Response, levels = rev(c("Strongly Disagree","Disagree","Neither Agree nor Disagree","Agree","Strongly Agree"))),
         Item = case_when(Item == "Q7_1" ~ "Staff provide individualized, person-centered care",
                          Item == "Q7_2" ~ "Older adults get the care they need ",
                          Item == "Q7_5" ~ "Staff are familiar with how aging affects treatment responses",
                          Item == "Q7_7" ~ "Aging is considered as a factor when planning and evaluating care",
                          Item == "Q7_11" ~ "Staff receive information about the older adult's pre-hospitalization baseline",
                          Item == "Q7_13" ~ "There is continuity of care across settings")) %>%
  mutate(Item = wrap_30(Item)) %>%
  ggplot(aes(x = Item, y = n, fill = Response)) +
  geom_bar(position = "fill", stat = "identity", width = .6, color = "white") +
  scale_y_continuous(labels = percent_format()) +
  scale_fill_manual(values = cols) +
  labs(y = "", x = "", fill = "") +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "right", text = element_text(size = 20, color = "black"),
        plot.margin = unit(c(-0.3, 0, 0, 0), "cm"),
        panel.border = element_blank())
```

<center>
**`r name`**
</center>

```{r,fig.width=13, fig.asp=.4}
giap %>%
  filter(Hospital.Name==name) %>% 
  select(Q7_1, Q7_2, Q7_5, Q7_7, Q7_11, Q7_13) %>%
  gather(Item, Response) %>% 
  count(Item, Response) %>%
  filter(!is.na(Response), Response != 9) %>%
  mutate(Response = case_when(Response == 1 ~ "Strongly Disagree",
                              Response == 2 ~ "Disagree",
                              Response == 3 ~ "Neither Agree nor Disagree",
                              Response == 4 ~ "Agree",
                              Response == 5 ~ "Strongly Agree"),
         Response = ordered(Response, levels = rev(c("Strongly Disagree","Disagree","Neither Agree nor Disagree","Agree","Strongly Agree"))),
         Item = case_when(Item == "Q7_1" ~ "Staff provide individualized, person-centered care",
                          Item == "Q7_2" ~ "Older adults get the care they need ",
                          Item == "Q7_5" ~ "Staff are familiar with how aging affects treatment responses",
                          Item == "Q7_7" ~ "Aging is considered as a factor when planning and evaluating care",
                          Item == "Q7_11" ~ "Staff receive information about the older adult's pre-hospitalization baseline",
                          Item == "Q7_13" ~ "There is continuity of care across settings")) %>%
  mutate(Item = wrap_30(Item)) %>%
  ggplot(aes(x = Item, y = n, fill = Response)) +
  geom_bar(position = "fill", stat = "identity", width = .6, color = "white") +
  scale_y_continuous(labels = percent_format()) +
  scale_fill_manual(values = cols) +
  labs(y = "", x = "", fill = "") +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "right", text = element_text(size = 20, color = "black"),
        plot.margin = unit(c(-0.3, 0, 0, 0), "cm"),
        panel.border = element_blank())
```

**Organizational Values to Support Age-Sensitive Care**

The following diagram illustrates nurses' perceptions regarding organizational values to provide nursing care tailored to the unique needs of older adults.

*(Note: These questions assess nurses' perceptions regarding barriers and the lack of specialized resources to care for older adults. For this diagram, higher levels of disagreement reflect nurses' perceptions that the organization values and supports care for older adults.)*

<center>
**Cohort Level**
</center>

```{r,fig.width=13, fig.height=5.5}
giap %>%
  select(Q8_1, Q8_2, Q8_5, Q8_11, Q8_12) %>%
  gather(Item, Response) %>% 
  count(Item, Response) %>%
  filter(!is.na(Response), Response != 9) %>%
  mutate(Response = case_when(Response == 1 ~ "Strongly Disagree",
                              Response == 2 ~ "Disagree",
                              Response == 3 ~ "Neither Agree nor Disagree",
                              Response == 4 ~ "Agree",
                              Response == 5 ~ "Strongly Agree"),
         Response = ordered(Response, levels = rev(c("Strongly Disagree","Disagree","Neither Agree nor Disagree","Agree","Strongly Agree"))),
         Item = case_when(Item == "Q8_1" ~ "Lack of knowledge about care of older adults",
                          Item == "Q8_2" ~ "Lack of (or inadequate) written policies and procedures specific to the older adult population",
                          Item == "Q8_5" ~ "Lack of specialized services for the older adult",
                          Item == "Q8_11" ~ "Communication difficulties with older adults and their families",
                          Item == "Q8_12" ~ "Confusion over who is the appropriate decision maker for the older adult")) %>%
  mutate(Item = wrap_30(Item)) %>%
  ggplot(aes(x = Item, y = n, fill = Response)) +
  geom_bar(position = "fill", stat = "identity", width = .6, color = "white") +
  scale_y_continuous(labels = percent_format()) +
  scale_fill_manual(values = cols) +
  labs(y = "", x = "", fill = "") +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "right", text = element_text(size = 20, color = "black"),
        plot.margin = unit(c(-0.3, 0, 0, 0), "cm"),
        panel.border = element_blank())
```

<center>
**`r name`**
</center>

```{r,fig.width=13, fig.height=5.5}
giap %>%
  filter(Hospital.Name==name) %>% 
  select(Q8_1, Q8_2, Q8_5, Q8_11, Q8_12) %>%
  gather(Item, Response) %>% 
  count(Item, Response) %>%
  filter(!is.na(Response), Response != 9) %>%
  mutate(Response = case_when(Response == 1 ~ "Strongly Disagree",
                              Response == 2 ~ "Disagree",
                              Response == 3 ~ "Neither Agree nor Disagree",
                              Response == 4 ~ "Agree",
                              Response == 5 ~ "Strongly Agree"),
         Response = ordered(Response, levels = rev(c("Strongly Disagree","Disagree","Neither Agree nor Disagree","Agree","Strongly Agree"))),
         Item = case_when(Item == "Q8_1" ~ "Lack of knowledge about care of older adults",
                          Item == "Q8_2" ~ "Lack of (or inadequate) written policies and procedures specific to the older adult population",
                          Item == "Q8_5" ~ "Lack of specialized services for the older adult",
                          Item == "Q8_11" ~ "Communication difficulties with older adults and their families",
                          Item == "Q8_12" ~ "Confusion over who is the appropriate decision maker for the older adult")) %>%
  mutate(Item = wrap_30(Item)) %>%
  ggplot(aes(x = Item, y = n, fill = Response)) +
  geom_bar(position = "fill", stat = "identity", width = .6, color = "white") +
  scale_y_continuous(labels = percent_format()) +
  scale_fill_manual(values = cols) +
  labs(y = "", x = "", fill = "") +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "right", text = element_text(size = 20, color = "black"),
        plot.margin = unit(c(-0.3, 0, 0, 0), "cm"),
        panel.border = element_blank())
```

**Unit Environment to Support Improvements in the Care of Older Adults**

The following diagram illustrates nurses' perceptions regarding the priority that nurse mangers and clinical leaders place on improving care for older adults.

<center>
**Cohort Level**
</center>

```{r, fig.width=13, fig.height=5.3}
giap %>%
  select(Q7_26, Q7_27, Q7_28, Q7_29, Q7_30) %>%
  gather(Item, Response) %>% 
  count(Item, Response) %>%
  filter(!is.na(Response), Response != 9) %>%
  mutate(Response = case_when(Response == 1 ~ "Strongly Disagree",
                              Response == 2 ~ "Disagree",
                              Response == 3 ~ "Neither Agree nor Disagree",
                              Response == 4 ~ "Agree",
                              Response == 5 ~ "Strongly Agree"),
         Response = ordered(Response, levels = rev(c("Strongly Disagree","Disagree","Neither Agree nor Disagree","Agree","Strongly Agree"))),
         Item = case_when(Item == "Q7_26" ~ "The time required to manage common nursing problems experienced by older adults is factored into staff assignments",
                          Item == "Q7_27" ~ "Training is readily available to staff that want to learn more about the care of older adults",
                          Item == "Q7_28" ~ "Staff are encouraged to take time off from their regular work tasks to implement new care practices",
                          Item == "Q7_29" ~ "The nurse administrators (unit managers, supervisors, senior leaders) take an active interest in improving care for older adults",
                          Item == "Q7_30" ~ "Care of the older adult is a priority on my unit")) %>%
  mutate(Item = wrap_30(Item)) %>%
  ggplot(aes(x = Item, y = n, fill = Response)) +
  geom_bar(position = "fill", stat = "identity", width = .6, color = "white") +
  scale_y_continuous(labels = percent_format()) +
  scale_fill_manual(values = cols) +
  labs(y = "", x = "", fill = "") +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "right", text = element_text(size = 20, color = "black"),
        plot.margin = unit(c(-0.3, 0, 0, 0), "cm"),
        panel.border = element_blank())
```

<center>
**`r name`**
</center>

```{r, fig.width=13, fig.height=5.3}
giap %>%
  filter(Hospital.Name==name) %>% 
  select(Q7_26, Q7_27, Q7_28, Q7_29, Q7_30) %>%
  gather(Item, Response) %>% 
  count(Item, Response) %>%
  filter(!is.na(Response), Response != 9) %>%
  mutate(Response = case_when(Response == 1 ~ "Strongly Disagree",
                              Response == 2 ~ "Disagree",
                              Response == 3 ~ "Neither Agree nor Disagree",
                              Response == 4 ~ "Agree",
                              Response == 5 ~ "Strongly Agree"),
         Response = ordered(Response, levels = rev(c("Strongly Disagree","Disagree","Neither Agree nor Disagree","Agree","Strongly Agree"))),
         Item = case_when(Item == "Q7_26" ~ "The time required to manage common nursing problems experienced by older adults is factored into staff assignments",
                          Item == "Q7_27" ~ "Training is readily available to staff that want to learn more about the care of older adults",
                          Item == "Q7_28" ~ "Staff are encouraged to take time off from their regular work tasks to implement new care practices",
                          Item == "Q7_29" ~ "The nurse administrators (unit managers, supervisors, senior leaders) take an active interest in improving care for older adults",
                          Item == "Q7_30" ~ "Care of the older adult is a priority on my unit")) %>%
  mutate(Item = wrap_30(Item)) %>%
  ggplot(aes(x = Item, y = n, fill = Response)) +
  geom_bar(position = "fill", stat = "identity", width = .6, color = "white") +
  scale_y_continuous(labels = percent_format()) +
  scale_fill_manual(values = cols) +
  labs(y = "", x = "", fill = "") +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "right", text = element_text(size = 20, color = "black"),
        plot.margin = unit(c(-0.3, 0, 0, 0), "cm"),
        panel.border = element_blank())
```

<center>
#### **Summary and Recommendations**
</center>

High quality care for older adults relies on two factors; a highly competent nursing workforce and care delivery processes that take the unique needs of older adults into account.  The GIAP evaluates nurses' knowledge and perceptions of the care environment to support high quality care for older adults.   The GIAP provides leaders with information to develop population-specific care for older adults at the nursing unit, hospital, and health system levels.

The results of the GIAP for the Spring 2018 cohort suggests that nurses' knowledge regarding evidence-based practices to care for older adults is aligned with national trends [@author3]. There are opportunities to improve nurses' knowledge to both assess and use evidence-based interventions to address the problems of nutrition and hydration, incontinence, and managing behaviors associated with dementia and cognitive decline among the population of older adults receiving care at your hospital. Some poor practices or uncertainty regarding the best interventions to promote optimal health outcomes for older adults were also identified.

In general, nurses perceive that organizational factors impede progress to deliver age-sensitive care. The participating staff identified a lack of time to both care for older adults and to devote to clinical practice change projects as barriers to providing age-friendly care on their units. The participating nurses also reported that there is a lack of equipment and professional expertise available to them on a daily basis to support high-quality care for older adults. Finally, participants reported that there is room for nurse managers and clinical leaders to communicate the importance of caring for older adults and to determine ways to integrate quality improvement and education into daily practice to develop clinical expertise and use evidence-based practices to care for older adults. 
    

<center>
**Summary**
</center>

This diagram summarizes the participating hospitals' performance on the knowledge and practice environment components of the GIAP survey. The majority of hospitals participating in the Spring 2018 survey fall within the **Early Quadrant**. Your hospital is marked with a bold dot. 


```{r}
ResAv <- giap %>%
  select(Hospital.Name, CASEID, 
         Q8_1, Q8_2, Q8_5, Q8_11, Q8_12) %>%
  gather(Item, Response, -Hospital.Name, -CASEID) %>% 
  filter(!is.na(Response), Response != 9) %>%
  mutate(Response = Response - 1,
         Item = case_when(Item == "Q8_1" ~ "Lack knowledge about care",
                          Item == "Q8_2" ~ "Lack written policy and procedure",
                          Item == "Q8_5" ~ "Lack of specialized services",
                          Item == "Q8_11" ~ "Communication difficulties",
                          Item == "Q8_12" ~ "Confusion regarding decision maker")) %>%
  group_by(Hospital.Name) %>%
  mutate(Resource_Availability_H = mean(Response)) %>%
  group_by(Hospital.Name, CASEID) %>%
  mutate(Resource_Availability_P = mean(Response)) %>%
  ungroup() %>%
  mutate(Resource_Availability_T = mean(Response))

AgeSensCare <- giap %>%
  select(Hospital.Name, CASEID, 
         Q7_1, Q7_2, Q7_5, Q7_7, Q7_11, Q7_13) %>%
  gather(Item, Response, -Hospital.Name, -CASEID) %>% 
  filter(!is.na(Response), Response != 9) %>%
  mutate(Response = Response -1,
         Item = case_when(Item == "Q7_1" ~ "Individualized care",
                          Item == "Q7_2" ~ "Care needed",
                          Item == "Q7_5" ~ "How aging affects treatment responses",
                          Item == "Q7_7" ~ "Aging is a factor in plan of care",
                          Item == "Q7_11" ~ "Pre-hospitalization baseline",
                          Item == "Q7_13" ~ "Continuity of care across settings")) %>%
  group_by(Hospital.Name) %>%
  mutate(Age_Sensitive_Care_H = mean(Response)) %>%
  group_by(Hospital.Name, CASEID) %>%
  mutate(Age_Sensitive_Care_P = mean(Response)) %>%
  ungroup() %>%
  mutate(Age_Sensitive_Care_T = mean(Response))

ImpClim <- giap %>%
  select(Hospital.Name, CASEID, 
         Q7_26, Q7_27, Q7_28, Q7_29, Q7_30) %>%
  gather(Item, Response, -Hospital.Name, -CASEID) %>% 
  filter(!is.na(Response), Response != 9) %>%
  mutate(Response = Response -1,
         Item = case_when(Item == "Q7_26" ~ "Time",
                          Item == "Q7_27" ~ "Training",
                          Item == "Q7_28" ~ "Time off work",
                          Item == "Q7_29" ~ "Nursing management",
                          Item == "Q7_30" ~ "Priority")) %>%
  group_by(Hospital.Name) %>%
  mutate(Implementation_Climate_H = mean(Response)) %>%
  group_by(Hospital.Name, CASEID) %>%
  mutate(Implementation_Climate_P = mean(Response)) %>%
  ungroup() %>%
  mutate(Implementation_Climate_T = mean(Response))

EduOpp <- giap %>%
  select(Hospital.Name, CASEID, 
         Q17) %>%
  gather(Item, Response, -Hospital.Name, -CASEID) %>% 
  filter(!is.na(Response), Response != 9) %>%
  mutate(Response = Response - 1,
         Item = case_when(Item == "Q17" ~ "Job your institution has done educating\nstaff about the care of the older adult")) %>%
  group_by(Hospital.Name) %>%
  mutate(Edu_Opp_H = mean(Response)) %>%
  group_by(Hospital.Name, CASEID) %>%
  mutate(Edu_Opp_P = mean(Response)) %>%
  ungroup() %>%
  mutate(Edu_Opp_T = mean(Response))

profile_DF <- list(ResAv %>% select(Hospital.Name, Resource_Availability_H) %>%unique(),
AgeSensCare %>% select(Hospital.Name, Age_Sensitive_Care_H) %>% unique(),
ImpClim %>% select(Hospital.Name, Implementation_Climate_H) %>% unique(),
EduOpp %>% select(Hospital.Name, Edu_Opp_H) %>% unique(),
Assess %>% select(Hospital.Name, Assess_H) %>% unique(),
Delirium %>% select(Hospital.Name, Delirium_H) %>% unique(),
Dementia %>% select(Hospital.Name, Dementia_H) %>% unique(),
Depression %>% select(Hospital.Name, Depression_H) %>% unique(),
Medication %>% select(Hospital.Name, Medication_H) %>% unique(),
Nutrition %>% select(Hospital.Name, Nutrition_H) %>% unique(),
Skin %>% select(Hospital.Name, Skin_H) %>% unique(),
Sleep %>% select(Hospital.Name, Sleep_H) %>% unique(),
Urinary %>% select(Hospital.Name, Urinary_H) %>% unique()) %>%
  reduce(full_join, by = "Hospital.Name") %>%
  gather(Variable, `Hospital Average`, -Hospital.Name) %>%
  mutate(Variable = gsub("_H", "", Variable),
         Variable = gsub("_", " ", Variable)) %>%
  group_by(Variable) %>%
  mutate(`Overall Average` = mean(`Hospital Average`)) %>%
  ungroup() %>%
  mutate(Variable = forcats::fct_reorder(Variable, `Overall Average`)) %>%
  gather(Level, Value, c(`Hospital Average`, `Overall Average`)) %>%
  mutate(Axis = ifelse(Variable %in% c("Assess", "Delirium", "Dementia", "Depression", "Falls", "Medication",
                                       "Nutrition", "Skin", "Sleep", "Urinary"), "Knowledge", 
                       "Practice Environment"))
```


```{r}
profile_DF %>%
  mutate(Hospital.Name = as.factor(Hospital.Name)) %>%
  group_by(Hospital.Name, Axis) %>%
  summarize(Mean = mean(Value)) %>%
  spread(., key = Axis, value = Mean) %>%
  ggplot(aes(x = `Practice Environment` / 4, y = Knowledge)) +
  geom_tile(aes(x = 0.64, y = 0.4, width = 0.24, height = 0.4), fill = "#6199AE") +
  geom_tile(aes(x = 0.64, y = 0.8, width = 0.24, height = 0.4), fill = "#E6E6E6") +
  geom_tile(aes(x = 0.88, y = 0.4, width = 0.24, height = 0.4), fill = "#E6E6E6") +
  geom_tile(aes(x = 0.88, y = 0.8, width = 0.24, height = 0.4), fill = "#6BAB8A") +
  geom_point(aes(shape = Hospital.Name == name), color = "black", size = 5) +
  geom_text(aes(x = 0.64, y = 0.4, label = "Early"), color = "white") +
  geom_text(aes(x = 0.64, y = 0.8, label = "Senior Friendly")) +
  geom_text(aes(x = 0.88, y = 0.4, label = "Senior Friendly")) +
  geom_text(aes(x = 0.88, y = 0.8, label = "Exemplary"), color = "white") +
  scale_x_continuous(limits=c(0.52,1), breaks = c(.64,.88), labels = c("Beginning","Advanced")) +
  scale_y_continuous(limits=c(0.2,1), breaks = c(.4,.8), labels = c("Beginning","Advanced")) +
  scale_shape_manual(values = c(1,19), labels = c("Peers", "You")) +
  labs(x = "Senior Friendly Practice", y = "Senior Friendly Knowledge") +
  theme_minimal() +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
  labs(shape = "")
```

Hospitals in the ***early quadrant*** are characterized by gaps in nurses' knowledge regarding evidence-based practices to assess and manage common nursing problems experienced by older adults during acute care hospital stays. Because nursing practice and population-based care approaches are embedded within unit-level care processes, hospitals in the early practice environment stage are characterized by limited resources and specialized services designed to meet the needs of older adults.

#####**Recommendations to Develop Your NICHE Program**
#####**`r name`**
#####**Early**

The information gained from the GIAP enables nurse managers and clinical leaders to prioritize continuing professional development and clinical quality improvement initiatives to implement the NICHE practice model. Based on your hospital's results we recommend: 

1. **Workforce Education**

    * Work with the nurse educators and unit nurse managers to identify gaps in nurses' knowledge, skills or practice. Align the nursing education priorities with the broader nursing practice development agenda.  
    
    * Initiate on-line or instructor-led staff education using the NICHE Geriatric Resource Nurse and Geriatric PCA/CNA programs.
    
    * Link continuing education priorities to the nursing process to identify gaps in staff's skills to assess, intervene, or evaluate nursing care to effectively manage  each geriatric syndrome or nursing problem. 
    
2. **Develop the Practice Environment to Support Age-Friendly Care**

    * Review the NICHE Protocols and other national clinical practice guidelines to integrate evidence-based practices in the nursing care policies, procedures, documentation and reporting processes 
      + Establish nurse-led protocols for falls/mobility, pressure injury prevention, urinary catheter management, medication reconciliation, and discharge planning, patient and caregiver teaching 
      
    * Develop the Geriatric Resource Nurse (GRN) role on participating units to oversee and lead interprofessional care planning and team development efforts 
      + Identify and select staff nurses ready to take the next step in their leadership careers.  We recommend that a minimum of three nurses per shift to serve as GRNs
      
    * Establish a NICHE Steering Committee and collaborate with the nursing practice councils to review policies, procedures and documentation systems to standardize data collection and care planning approaches based on the NICHE Protocols and other national clinical practice guidelines for older adults. 
    
3. **Share results and publicize nurses' accomplishments to establish Age-Friendly care**

    * If there are discrepancy between nurses' perceptions and the actual availability of equipment or specialty geriatric services at your hospital, consider a marketing campaign targeting the front line staff to raise awareness about these resources to support the care of older adults.
    
    * Work with your hospital's communications department to publicize staff participation in the NICHE program 
    
    * Present data about changes in patient outcomes and satisfaction, nurse satisfaction and engagement or cost reductions resulting from quality improvement initiatives carried out under the NICHE program 
    
**Technical Note:  GIAP Survey and Data Analysis**

This technical note provides an overview of the GIAP survey and the data analyses used to generate this report.

The GIAP is assesses the following components of the nursing practice environment: 

**Geriatric Nursing Knowledge**

Nurses' abilities to recognize the multifactorial clinical problems commonly experienced by older adults and appropriately intervene is integral to improving clinical outcomes for older adults. The GIAP assess nurses' knowledge about evidence-based interventions to manage the geriatric syndromes of skin injuries, incontinence, falls, delirium, and the nursing problems of managing dementia behaviors, restraint use, nutrition and hydration, and pain management. A sample question from this section is: "Medications are the only way to treat behavioral symptoms in persons living with dementia. 

**Specialized Resources**

This scale assesses nurses' perceptions about the availably of specialized resources to deliver care to older adults. Respondents are asked to rate the extent to which durable medical equipment, clinical resources, and information from colleagues and families are available to plan and implement care for older adults. A sample question from this scale is: "Lack of written policies and procedures specific to the older adult population are a barrier to providing care to older adults."

 
**Age-Friendly Care Planning and Delivery**

This scale assesses nurses' perceptions about the organization and delivery of nursing care that takes the unique physical, emotional and psychological needs of older adults into account.   Respondents are asked to rate the extent to which they agree or disagree with a series of questions on a five-point Likert agreement scale. A sample question from this scale is: "Staff provided individualized, person-centered care." 

**Organizational Values to Support Age-Friendly Care**

The organizational values scale assesses nurses' perceptions of the ways that staff work together to create a practice environment that values and supports the unique care needs of older adults. Respondents are asked to rate the extent to which they agree with a series of statements on a five-point Likert scale. A sample question from this scale is "Clinicians and administrators work together to solve problems facing older adult patients." 

**Unit Environment to Support Improvements in Care of Older Adults**

Changing nursing practice to improve the quality of care is challenging and requires a well-defined change management plan. The questions in the unit environment scale provides information about nurses' perceptions of the time required to care for older adults and the role of the nurse managers and clinical leaders to support the use of evidence-based clinical practices know to improve health outcomes for older adults. A sample question from this scale is "Care of the older adult is a priority on my unit."   

The GIAP scales each contain between five and eleven questions and the coefficient alphas for the scales range between 0.81 and 0.94.

**Sample**

Registered nurses and nursing assistants/patient care associates between the ages of 18 -70 years, working on the nursing units implementing the NICHE nursing practice model, were invited to participate in the GIAP. Staff working on a full-time or part-time basis are eligible to participate in the survey. Because the GIAP focuses on nurses' knowledge and perceptions, the sample is limited to nursing personnel.

33 NICHE member hospitals participated in the Feb 2018 GIAP survey. Within the 33 hospitals, 3075 nurses were eligible to participate. We received complete data from 1012 respondents, which equates to a 32.91% response rate.

**Data analysis**

The data were pooled across participating hospitals. We analyzed the cohort and individual hospital data using descriptive statistics.

*Knowledge Scores:* The percentage of correct responses were calculated for each topic and the mean score is marked with an asterisk. Following standard practice in continuing nursing education, a mean score of 80% denotes nurses' mastery of interventions to effectively identify and manage common health problems and complications of hospitalization experienced by older adults.  

*Scale construction:* The survey data were aggregated to the unit-level and reported for each participating hospital. The aggregated cohort data provides insights into the state of geriatric nursing practice at participating hospitals and can be used to inform the development of policies, procedures and services to support age-friendly nursing care.

#### **References**